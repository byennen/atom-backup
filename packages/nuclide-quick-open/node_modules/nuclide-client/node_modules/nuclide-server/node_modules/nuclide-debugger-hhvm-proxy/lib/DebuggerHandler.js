
/*
 * Copyright (c) 2015-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the license found in the LICENSE file in
 * the root directory of this source tree.
 */

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, 'next'); var callThrow = step.bind(null, 'throw'); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _require = require('./utils');

var log = _require.log;
var logErrorAndThrow = _require.logErrorAndThrow;
var uriToPath = _require.uriToPath;

var Handler = require('./Handler');

var _require2 = require('./DbgpSocket');

var STATUS_STARTING = _require2.STATUS_STARTING;
var STATUS_STOPPING = _require2.STATUS_STOPPING;
var STATUS_STOPPED = _require2.STATUS_STOPPED;
var STATUS_RUNNING = _require2.STATUS_RUNNING;
var STATUS_BREAK = _require2.STATUS_BREAK;
var COMMAND_RUN = _require2.COMMAND_RUN;
var COMMAND_STEP_INTO = _require2.COMMAND_STEP_INTO;
var COMMAND_STEP_OVER = _require2.COMMAND_STEP_OVER;
var COMMAND_STEP_OUT = _require2.COMMAND_STEP_OUT;
var COMMAND_STOP = _require2.COMMAND_STOP;

var SESSION_END_EVENT = 'session-end-event';

// Handles all 'Debug.*' Chrome dev tools messages

var DebuggerHandler = (function (_Handler) {
  _inherits(DebuggerHandler, _Handler);

  function DebuggerHandler(callback, socket, dataCache) {
    _classCallCheck(this, DebuggerHandler);

    _get(Object.getPrototypeOf(DebuggerHandler.prototype), 'constructor', this).call(this, 'Debugger', callback);

    this._socket = socket;
    this._dataCache = dataCache;
    var FileCache = require('./FileCache');
    this._files = new FileCache(callback);

    var _require3 = require('events');

    var EventEmitter = _require3.EventEmitter;

    this._emitter = new EventEmitter();
  }

  _createClass(DebuggerHandler, [{
    key: 'onSessionEnd',
    value: function onSessionEnd(callback) {
      log('onSessionEnd');
      this._emitter.on(SESSION_END_EVENT, callback);
    }
  }, {
    key: 'handleMethod',
    value: _asyncToGenerator(function* (id, method, params) {

      switch (method) {

        // TODO: Add Console (aka logging) support
        case 'enable':
          yield this._debuggerEnable(id);
          break;

        case 'pause':
          yield this._sendBreakCommand(id);
          break;

        case 'stepInto':
          yield this._sendContinuationCommand(COMMAND_STEP_INTO);
          break;

        case 'stepOut':
          yield this._sendContinuationCommand(COMMAND_STEP_OUT);
          break;

        case 'stepOver':
          yield this._sendContinuationCommand(COMMAND_STEP_OVER);
          break;

        case 'resume':
          yield this._sendContinuationCommand(COMMAND_RUN);
          break;

        case 'setPauseOnExceptions':
          this.replyWithError(id, 'Not implemented');
          break;

        case 'setAsyncCallStackDepth':
        case 'skipStackFrames':
          this.replyWithError(id, 'Not implemented');
          break;

        case 'getScriptSource':
          // TODO: Handle file read errors.
          // TODO: Handle non-file scriptIds
          this.replyToCommand(id, { scriptSource: yield this._files.getFileSource(params.scriptId) });
          break;

        case 'setBreakpointByUrl':
          yield this._setBreakpointByUrl(id, params);
          break;

        case 'removeBreakpoint':
          yield this._removeBreakpoint(id, params);
          break;

        default:
          this.unknownMethod(id, method, params);
          break;
      }
    })
  }, {
    key: '_setBreakpointByUrl',
    value: _asyncToGenerator(function* (id, params) {
      var lineNumber = params.lineNumber;
      var url = params.url;
      var columnNumber = params.columnNumber;
      var condition = params.condition;

      if (!url || condition !== '' || columnNumber !== 0) {
        this.replyWithError(id, 'Invalid arguments to Debugger.setBreakpointByUrl: ' + JSON.stringify(params));
        return;
      }

      try {
        var path = uriToPath(url);
        this._files.registerFile(path);
        var breakpointId = yield this._socket.setBreakpoint(path, lineNumber + 1);
        this.replyToCommand(id, {
          breakpointId: breakpointId,
          locations: [{
            lineNumber: lineNumber,
            scriptId: path
          }] });
      } catch (e) {
        this.replyWithError(id, e.message);
      }
    })
  }, {
    key: '_removeBreakpoint',
    value: _asyncToGenerator(function* (id, params) {
      var breakpointId = params.breakpointId;

      yield this._socket.removeBreakpoint(breakpointId);
      this.replyToCommand(id, { id: breakpointId });
    })
  }, {
    key: '_debuggerEnable',
    value: _asyncToGenerator(function* (id) {
      yield this._sendStatus((yield this._getStatus()));
      this.replyToCommand(id, {});
    })
  }, {
    key: '_getStackFrames',
    value: _asyncToGenerator(function* () {
      var _this = this;

      var frames = yield this._socket.getStackFrames();
      return yield Promise.all(frames.stack.map(function (frame, frameIndex) {
        return _this._convertFrame(frame, frameIndex);
      }));
    })
  }, {
    key: '_convertFrame',
    value: _asyncToGenerator(function* (frame, frameIndex) {
      log('Converting frame: ' + JSON.stringify(frame));
      try {
        var _require4 = require('./frame');

        var idOfFrame = _require4.idOfFrame;
        var functionOfFrame = _require4.functionOfFrame;
        var fileOfFrame = _require4.fileOfFrame;
        var locationOfFrame = _require4.locationOfFrame;

        this._files.registerFile(fileOfFrame(frame));
        return {
          callFrameId: idOfFrame(frame),
          functionName: functionOfFrame(frame),
          location: locationOfFrame(frame),
          scopeChain: yield this._dataCache.getScopesForFrame(frameIndex)
        };
      } catch (e) {
        logErrorAndThrow('Exception converting frame: ' + e + ' ' + e.stack);
      }
    })

    // Returns one of:
    //  starting, stopping, stopped, running, break
  }, {
    key: '_getStatus',
    value: function _getStatus() {
      return this._socket.getStatus();
    }

    // Continuation commands get a response, but that response
    // is a status message which occurs after execution stops.
  }, {
    key: '_sendContinuationCommand',
    value: _asyncToGenerator(function* (command) {
      log('Sending continuation command: ' + command);
      this._dataCache.disable();
      var statusPromise = this._socket.sendContinuationCommand(command);
      this.sendMethod('Debugger.resumed');
      yield this._sendStatus((yield statusPromise));
    })
  }, {
    key: '_sendBreakCommand',
    value: _asyncToGenerator(function* (id) {
      var response = yield this._socket.sendBreakCommand();
      if (!response) {
        this.replyWithError(id, 'Unable to break');
      }
    })
  }, {
    key: '_sendStatus',
    value: _asyncToGenerator(function* (status) {
      log('Sending status: ' + status);
      switch (status) {
        case STATUS_STARTING:
          // Starting status has no stack.
          // step before reporting initial status to get to the first instruction.
          yield this._sendContinuationCommand(COMMAND_STEP_INTO);
          break;
        case STATUS_BREAK:
          this._dataCache.enable();
          yield this._sendPausedMessage();
          break;
        case STATUS_RUNNING:
          logErrorAndThrow('Unexpected running status');
          break;
        case STATUS_STOPPING:
          // TODO: May want to enable post-mortem features?
          yield this._sendContinuationCommand(COMMAND_STOP);
          break;
        case STATUS_STOPPED:
          this.sendMethod('Debugger.paused', {
            callFrames: [],
            reason: 'breakpoint', // TODO: better reason?
            data: {}
          });
          this._endSession();
          break;
        default:
          logErrorAndThrow('Unexpected status: ' + status);
      }
    })

    // May only call when in paused state.
  }, {
    key: '_sendPausedMessage',
    value: _asyncToGenerator(function* () {
      this.sendMethod('Debugger.paused', {
        callFrames: yield this._getStackFrames(),
        reason: 'breakpoint', // TODO: better reason?
        data: {}
      });
    })
  }, {
    key: '_endSession',
    value: function _endSession() {
      log('DebuggerHandler: Ending session');
      this._emitter.emit(SESSION_END_EVENT);
    }
  }]);

  return DebuggerHandler;
})(Handler);

module.exports = DebuggerHandler;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBlbW0ySHVwdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLWRlYnVnZ2VyLWhodm0tcHJveHkvbGliL0RlYnVnZ2VySGFuZGxlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxXQUFXLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O2VBWTZCLE9BQU8sQ0FBQyxTQUFTLENBQUM7O0lBQXRELEdBQUcsWUFBSCxHQUFHO0lBQUUsZ0JBQWdCLFlBQWhCLGdCQUFnQjtJQUFFLFNBQVMsWUFBVCxTQUFTOztBQUNyQyxJQUFJLE9BQU8sR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7O2dCQVkvQixPQUFPLENBQUMsY0FBYyxDQUFDOztJQVZ6QixlQUFlLGFBQWYsZUFBZTtJQUNmLGVBQWUsYUFBZixlQUFlO0lBQ2YsY0FBYyxhQUFkLGNBQWM7SUFDZCxjQUFjLGFBQWQsY0FBYztJQUNkLFlBQVksYUFBWixZQUFZO0lBQ1osV0FBVyxhQUFYLFdBQVc7SUFDWCxpQkFBaUIsYUFBakIsaUJBQWlCO0lBQ2pCLGlCQUFpQixhQUFqQixpQkFBaUI7SUFDakIsZ0JBQWdCLGFBQWhCLGdCQUFnQjtJQUNoQixZQUFZLGFBQVosWUFBWTs7QUFHZCxJQUFNLGlCQUFpQixHQUFHLG1CQUFtQixDQUFDOzs7O0lBR3hDLGVBQWU7WUFBZixlQUFlOztBQU1SLFdBTlAsZUFBZSxDQU1QLFFBQXdCLEVBQUUsTUFBa0IsRUFBRSxTQUFvQixFQUFFOzBCQU41RSxlQUFlOztBQU9qQiwrQkFQRSxlQUFlLDZDQU9YLFVBQVUsRUFBRSxRQUFRLEVBQUU7O0FBRTVCLFFBQUksQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO0FBQ3RCLFFBQUksQ0FBQyxVQUFVLEdBQUcsU0FBUyxDQUFDO0FBQzVCLFFBQUksU0FBUyxHQUFHLE9BQU8sQ0FBQyxhQUFhLENBQUMsQ0FBQztBQUN2QyxRQUFJ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QUU7V0FDVCxDQUFDLENBQUM7QUFDTCxjQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7QUFDbkIsZ0JBQU07QUFBQSxBQUNSO0FBQ0UsMEJBQWdCLENBQUMscUJBQXFCLEdBQUcsTUFBTSxDQUFDLENBQUM7QUFBQSxPQUNsRDtLQUNGOzs7Ozs2QkFHdUIsYUFBWTtBQUNsQyxVQUFJLENBQUMsVUFBVSxDQUNiLGlCQUFpQixFQUNqQjtBQUNFLGtCQUFVLEVBQUUsTUFBTSxJQUFJLENBQUMsZUFBZSxFQUFFO0FBQ3hDLGNBQU0sRUFBRSxZQUFZO0FBQ3BCLFlBQUksRUFBRSxFQUFFO09BQ1QsQ0FBQyxDQUFDO0tBQ047OztXQUVVLHVCQUFTO0FBQ2xCLFNBQUcsQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFDO0FBQ3ZDLFVBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUM7S0FDdkM7OztTQXRORyxlQUFlO0dBQVMsT0FBTzs7QUF5TnJDLE1BQU0sQ0FBQyxPQUFPLEdBQUcsZUFBZSxDQUFDIiwiZmlsZSI6Ii92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBlbW0ySHVwdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLWRlYnVnZ2VyLWhodm0tcHJveHkvbGliL0RlYnVnZ2VySGFuZGxlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2UgYmFiZWwnO1xuLyogQGZsb3cgKi9cblxuLypcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBsaWNlbnNlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW5cbiAqIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5cblxudmFyIHtsb2csIGxvZ0Vycm9yQW5kVGhyb3csIHVyaVRvUGF0aH0gPSByZXF1aXJlKCcuL3V0aWxzJyk7XG52YXIgSGFuZGxlciA9IHJlcXVpcmUoJy4vSGFuZGxlcicpO1xudmFyIHtcbiAgU1RBVFVTX1NUQVJUSU5HLFxuICBTVEFUVVNfU1RPUFBJTkcsXG4gIFNUQVRVU19TVE9QUEVELFxuICBTVEFUVVNfUlVOTklORyxcbiAgU1RBVFVTX0JSRUFLLFxuICBDT01NQU5EX1JVTixcbiAgQ09NTUFORF9TVEVQX0lOVE8sXG4gIENPTU1BTkRfU1RFUF9PVkVSLFxuICBDT01NQU5EX1NURVBfT1VULFxuICBDT01NQU5EX1NUT1AsXG59ID0gcmVxdWlyZSgnLi9EYmdwU29ja2V0Jyk7XG5cbmNvbnN0IFNFU1NJT05fRU5EX0VWRU5UID0gJ3Nlc3Npb24tZW5kLWV2ZW50JztcblxuLy8gSGFuZGxlcyBhbGwgJ0RlYnVnLionIENocm9tZSBkZXYgdG9vbHMgbWVzc2FnZXNcbmNsYXNzIERlYnVnZ2VySGFuZGxlciBleHRlbmRzIEhhbmRsZXIge1xuICBfc29ja2V0OiBEYmdwU29ja2V0O1xuICBfZGF0YUNhY2hlOiBEYXRhQ2FjaGU7XG4gIF9maWxlczogRmlsZUNhY2hlO1xuICBfZW1pdHRlcjogRXZlbnRFbWl0dGVyO1xuXG4gIGNvbnN0cnVjdG9yKGNhbGxiYWNrOiBDaHJvbWVDYWxsYmFjaywgc29ja2V0OiBEYmdwU29ja2V0LCBkYXRhQ2FjaGU6IERhdGFDYWNoZSkge1xuICAgIHN1cGVyKCdEZWJ1Z2dlcicsIGNhbGxiYWNrKTtcblxuICAgIHRoaXMuX3NvY2tldCA9IHNvY2tldDtcbiAgICB0aGlzLl9kYXRhQ2FjaGUgPSBkYXRhQ2FjaGU7XG4gICAgdmFyIEZpbGVDYWNoZSA9IHJlcXVpcmUoJy4vRmlsZUNhY2hlJyk7XG4gICAgdGhpcy5fZmlsZXMgPSBuZXcgRmlsZUNhY2hlKGNhbGxiYWNrKTtcbiAgICB2YXIge0V2ZW50RW1pdHRlcn0gPSByZXF1aXJlKCdldmVudHMnKTtcbiAgICB0aGlzLl9lbWl0dGVyID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICB9XG5cbiAgb25TZXNzaW9uRW5kKGNhbGxiYWNrOiAoKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgbG9nKCdvblNlc3Npb25FbmQnKTtcbiAgICB0aGlzLl9lbWl0dGVyLm9uKFNFU1NJT05fRU5EX0VWRU5ULCBjYWxsYmFjayk7XG4gIH1cblxuICBhc3luYyBoYW5kbGVNZXRob2QoaWQ6IG51bWJlciwgbWV0aG9kOiBzdHJpbmcsIHBhcmFtczogP09iamVjdCk6IFByb21pc2Uge1xuXG4gICAgc3dpdGNoIChtZXRob2QpIHtcblxuICAgIC8vIFRPRE86IEFkZCBDb25zb2xlIChha2EgbG9nZ2luZykgc3VwcG9ydFxuICAgIGNhc2UgJ2VuYWJsZSc6XG4gICAgICBhd2FpdCB0aGlzLl9kZWJ1Z2dlckVuYWJsZShpZCk7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ3BhdXNlJzpcbiAgICAgIGF3YWl0IHRoaXMuX3NlbmRCcmVha0NvbW1hbmQoaWQpO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdzdGVwSW50byc6XG4gICAgICBhd2FpdCB0aGlzLl9zZW5kQ29udGludWF0aW9uQ29tbWFuZChDT01NQU5EX1NURVBfSU5UTyk7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ3N0ZXBPdXQnOlxuICAgICAgYXdhaXQgdGhpcy5fc2VuZENvbnRpbnVhdGlvbkNvbW1hbmQoQ09NTUFORF9TVEVQX09VVCk7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ3N0ZXBPdmVyJzpcbiAgICAgIGF3YWl0IHRoaXMuX3NlbmRDb250aW51YXRpb25Db21tYW5kKENPTU1BTkRfU1RFUF9PVkVSKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAncmVzdW1lJzpcbiAgICAgIGF3YWl0IHRoaXMuX3NlbmRDb250aW51YXRpb25Db21tYW5kKENPTU1BTkRfUlVOKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnc2V0UGF1c2VPbkV4Y2VwdGlvbnMnOlxuICAgICAgdGhpcy5yZXBseVdpdGhFcnJvcihpZCwgJ05vdCBpbXBsZW1lbnRlZCcpO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdzZXRBc3luY0NhbGxTdGFja0RlcHRoJzpcbiAgICBjYXNlICdza2lwU3RhY2tGcmFtZXMnOlxuICAgICAgdGhpcy5yZXBseVdpdGhFcnJvcihpZCwgJ05vdCBpbXBsZW1lbnRlZCcpO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdnZXRTY3JpcHRTb3VyY2UnOlxuICAgICAgLy8gVE9ETzogSGFuZGxlIGZpbGUgcmVhZCBlcnJvcnMuXG4gICAgICAvLyBUT0RPOiBIYW5kbGUgbm9uLWZpbGUgc2NyaXB0SWRzXG4gICAgICB0aGlzLnJlcGx5VG9Db21tYW5kKGlkLCB7IHNjcmlwdFNvdXJjZTogYXdhaXQgdGhpcy5fZmlsZXMuZ2V0RmlsZVNvdXJjZShwYXJhbXMuc2NyaXB0SWQpIH0pO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdzZXRCcmVha3BvaW50QnlVcmwnOlxuICAgICAgYXdhaXQgdGhpcy5fc2V0QnJlYWtwb2ludEJ5VXJsKGlkLCBwYXJhbXMpO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdyZW1vdmVCcmVha3BvaW50JzpcbiAgICAgIGF3YWl0IHRoaXMuX3JlbW92ZUJyZWFrcG9pbnQoaWQsIHBhcmFtcyk7XG4gICAgICBicmVhaztcblxuICAgIGRlZmF1bHQ6XG4gICAgICB0aGlzLnVua25vd25NZXRob2QoaWQsIG1ldGhvZCwgcGFyYW1zKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIF9zZXRCcmVha3BvaW50QnlVcmwoaWQ6IG51bWJlciwgcGFyYW1zOiBPYmplY3QpOiBQcm9taXNlIHtcbiAgICB2YXIge2xpbmVOdW1iZXIsIHVybCwgY29sdW1uTnVtYmVyLCBjb25kaXRpb259ID0gcGFyYW1zO1xuICAgIGlmICghdXJsIHx8IGNvbmRpdGlvbiAhPT0gJycgfHwgY29sdW1uTnVtYmVyICE9PSAwKSB7XG4gICAgICB0aGlzLnJlcGx5V2l0aEVycm9yKGlkLCAnSW52YWxpZCBhcmd1bWVudHMgdG8gRGVidWdnZXIuc2V0QnJlYWtwb2ludEJ5VXJsOiAnICsgSlNPTi5zdHJpbmdpZnkocGFyYW1zKSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHZhciBwYXRoID0gdXJpVG9QYXRoKHVybCk7XG4gICAgICB0aGlzLl9maWxlcy5yZWdpc3RlckZpbGUocGF0aCk7XG4gICAgICB2YXIgYnJlYWtwb2ludElkID0gYXdhaXQgdGhpcy5fc29ja2V0LnNldEJyZWFrcG9pbnQocGF0aCwgbGluZU51bWJlciArIDEpO1xuICAgICAgdGhpcy5yZXBseVRvQ29tbWFuZChpZCwge1xuICAgICAgICBicmVha3BvaW50SWQ6IGJyZWFrcG9pbnRJZCxcbiAgICAgICAgbG9jYXRpb25zOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgbGluZU51bWJlcixcbiAgICAgICAgICAgIHNjcmlwdElkOiBwYXRoLFxuICAgICAgICAgIH0sXG4gICAgICAgIF19KTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgdGhpcy5yZXBseVdpdGhFcnJvcihpZCwgZS5tZXNzYWdlKTtcbiAgICAgIH1cbiAgfVxuXG4gIGFzeW5jIF9yZW1vdmVCcmVha3BvaW50KGlkOiBudW1iZXIsIHBhcmFtczogT2JqZWN0KTogUHJvbWlzZSB7XG4gICAgdmFyIHticmVha3BvaW50SWR9ID0gcGFyYW1zO1xuICAgIGF3YWl0IHRoaXMuX3NvY2tldC5yZW1vdmVCcmVha3BvaW50KGJyZWFrcG9pbnRJZCk7XG4gICAgdGhpcy5yZXBseVRvQ29tbWFuZChpZCwge2lkOiBicmVha3BvaW50SWR9KTtcbiAgfVxuXG4gIGFzeW5jIF9kZWJ1Z2dlckVuYWJsZShpZDogbnVtYmVyKTogUHJvbWlzZSB7XG4gICAgYXdhaXQgdGhpcy5fc2VuZFN0YXR1cyhhd2FpdCB0aGlzLl9nZXRTdGF0dXMoKSk7XG4gICAgdGhpcy5yZXBseVRvQ29tbWFuZChpZCwge30pO1xuICB9XG5cbiAgYXN5bmMgX2dldFN0YWNrRnJhbWVzKCk6IFByb21pc2U8QXJyYXk8T2JqZWN0Pj4ge1xuICAgIHZhciBmcmFtZXMgPSBhd2FpdCB0aGlzLl9zb2NrZXQuZ2V0U3RhY2tGcmFtZXMoKTtcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICBmcmFtZXMuc3RhY2subWFwKChmcmFtZSwgZnJhbWVJbmRleCkgPT4gdGhpcy5fY29udmVydEZyYW1lKGZyYW1lLCBmcmFtZUluZGV4KSkpO1xuICB9XG5cbiAgYXN5bmMgX2NvbnZlcnRGcmFtZShmcmFtZTogT2JqZWN0LCBmcmFtZUluZGV4OiBudW1iZXIpOiBQcm9taXNlPE9iamVjdD4ge1xuICAgIGxvZygnQ29udmVydGluZyBmcmFtZTogJyArIEpTT04uc3RyaW5naWZ5KGZyYW1lKSk7XG4gICAgdHJ5IHtcbiAgICAgIHZhciB7XG4gICAgICAgIGlkT2ZGcmFtZSxcbiAgICAgICAgZnVuY3Rpb25PZkZyYW1lLFxuICAgICAgICBmaWxlT2ZGcmFtZSxcbiAgICAgICAgbG9jYXRpb25PZkZyYW1lLFxuICAgICAgfSA9IHJlcXVpcmUoJy4vZnJhbWUnKTtcblxuICAgICAgdGhpcy5fZmlsZXMucmVnaXN0ZXJGaWxlKGZpbGVPZkZyYW1lKGZyYW1lKSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjYWxsRnJhbWVJZDogaWRPZkZyYW1lKGZyYW1lKSxcbiAgICAgICAgZnVuY3Rpb25OYW1lOiBmdW5jdGlvbk9mRnJhbWUoZnJhbWUpLFxuICAgICAgICBsb2NhdGlvbjogbG9jYXRpb25PZkZyYW1lKGZyYW1lKSxcbiAgICAgICAgc2NvcGVDaGFpbjogYXdhaXQgdGhpcy5fZGF0YUNhY2hlLmdldFNjb3Blc0ZvckZyYW1lKGZyYW1lSW5kZXgpLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2dFcnJvckFuZFRocm93KCdFeGNlcHRpb24gY29udmVydGluZyBmcmFtZTogJyArIGUgKyAnICcgKyBlLnN0YWNrKTtcbiAgICB9XG4gIH1cblxuICAvLyBSZXR1cm5zIG9uZSBvZjpcbiAgLy8gIHN0YXJ0aW5nLCBzdG9wcGluZywgc3RvcHBlZCwgcnVubmluZywgYnJlYWtcbiAgX2dldFN0YXR1cygpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIHJldHVybiB0aGlzLl9zb2NrZXQuZ2V0U3RhdHVzKCk7XG4gIH1cblxuICAvLyBDb250aW51YXRpb24gY29tbWFuZHMgZ2V0IGEgcmVzcG9uc2UsIGJ1dCB0aGF0IHJlc3BvbnNlXG4gIC8vIGlzIGEgc3RhdHVzIG1lc3NhZ2Ugd2hpY2ggb2NjdXJzIGFmdGVyIGV4ZWN1dGlvbiBzdG9wcy5cbiAgYXN5bmMgX3NlbmRDb250aW51YXRpb25Db21tYW5kKGNvbW1hbmQ6IHN0cmluZyk6IFByb21pc2Uge1xuICAgIGxvZygnU2VuZGluZyBjb250aW51YXRpb24gY29tbWFuZDogJyArIGNvbW1hbmQpO1xuICAgIHRoaXMuX2RhdGFDYWNoZS5kaXNhYmxlKCk7XG4gICAgdmFyIHN0YXR1c1Byb21pc2UgPSB0aGlzLl9zb2NrZXQuc2VuZENvbnRpbnVhdGlvbkNvbW1hbmQoY29tbWFuZCk7XG4gICAgdGhpcy5zZW5kTWV0aG9kKCdEZWJ1Z2dlci5yZXN1bWVkJyk7XG4gICAgYXdhaXQgdGhpcy5fc2VuZFN0YXR1cyhhd2FpdCBzdGF0dXNQcm9taXNlKTtcbiAgfVxuXG4gIGFzeW5jIF9zZW5kQnJlYWtDb21tYW5kKGlkOiBudW1iZXIpOiBQcm9taXNlIHtcbiAgICB2YXIgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLl9zb2NrZXQuc2VuZEJyZWFrQ29tbWFuZCgpO1xuICAgIGlmICghcmVzcG9uc2UpIHtcbiAgICAgIHRoaXMucmVwbHlXaXRoRXJyb3IoaWQsICdVbmFibGUgdG8gYnJlYWsnKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBfc2VuZFN0YXR1cyhzdGF0dXM6IHN0cmluZyk6IFByb21pc2Uge1xuICAgIGxvZygnU2VuZGluZyBzdGF0dXM6ICcgKyBzdGF0dXMpO1xuICAgIHN3aXRjaCAoc3RhdHVzKSB7XG4gICAgY2FzZSBTVEFUVVNfU1RBUlRJTkc6XG4gICAgICAvLyBTdGFydGluZyBzdGF0dXMgaGFzIG5vIHN0YWNrLlxuICAgICAgLy8gc3RlcCBiZWZvcmUgcmVwb3J0aW5nIGluaXRpYWwgc3RhdHVzIHRvIGdldCB0byB0aGUgZmlyc3QgaW5zdHJ1Y3Rpb24uXG4gICAgICBhd2FpdCB0aGlzLl9zZW5kQ29udGludWF0aW9uQ29tbWFuZChDT01NQU5EX1NURVBfSU5UTyk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFNUQVRVU19CUkVBSzpcbiAgICAgIHRoaXMuX2RhdGFDYWNoZS5lbmFibGUoKTtcbiAgICAgIGF3YWl0IHRoaXMuX3NlbmRQYXVzZWRNZXNzYWdlKCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFNUQVRVU19SVU5OSU5HOlxuICAgICAgbG9nRXJyb3JBbmRUaHJvdygnVW5leHBlY3RlZCBydW5uaW5nIHN0YXR1cycpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBTVEFUVVNfU1RPUFBJTkc6XG4gICAgICAvLyBUT0RPOiBNYXkgd2FudCB0byBlbmFibGUgcG9zdC1tb3J0ZW0gZmVhdHVyZXM/XG4gICAgICBhd2FpdCB0aGlzLl9zZW5kQ29udGludWF0aW9uQ29tbWFuZChDT01NQU5EX1NUT1ApO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBTVEFUVVNfU1RPUFBFRDpcbiAgICAgIHRoaXMuc2VuZE1ldGhvZChcbiAgICAgICAgJ0RlYnVnZ2VyLnBhdXNlZCcsXG4gICAgICAgIHtcbiAgICAgICAgICBjYWxsRnJhbWVzOiBbXSxcbiAgICAgICAgICByZWFzb246ICdicmVha3BvaW50JywgLy8gVE9ETzogYmV0dGVyIHJlYXNvbj9cbiAgICAgICAgICBkYXRhOiB7fSxcbiAgICAgICAgfSk7XG4gICAgICB0aGlzLl9lbmRTZXNzaW9uKCk7XG4gICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgbG9nRXJyb3JBbmRUaHJvdygnVW5leHBlY3RlZCBzdGF0dXM6ICcgKyBzdGF0dXMpO1xuICAgIH1cbiAgfVxuXG4gIC8vIE1heSBvbmx5IGNhbGwgd2hlbiBpbiBwYXVzZWQgc3RhdGUuXG4gIGFzeW5jIF9zZW5kUGF1c2VkTWVzc2FnZSgpOiBQcm9taXNlIHtcbiAgICB0aGlzLnNlbmRNZXRob2QoXG4gICAgICAnRGVidWdnZXIucGF1c2VkJyxcbiAgICAgIHtcbiAgICAgICAgY2FsbEZyYW1lczogYXdhaXQgdGhpcy5fZ2V0U3RhY2tGcmFtZXMoKSxcbiAgICAgICAgcmVhc29uOiAnYnJlYWtwb2ludCcsIC8vIFRPRE86IGJldHRlciByZWFzb24/XG4gICAgICAgIGRhdGE6IHt9LFxuICAgICAgfSk7XG4gIH1cblxuICBfZW5kU2Vzc2lvbigpOiB2b2lkIHtcbiAgICBsb2coJ0RlYnVnZ2VySGFuZGxlcjogRW5kaW5nIHNlc3Npb24nKTtcbiAgICB0aGlzLl9lbWl0dGVyLmVtaXQoU0VTU0lPTl9FTkRfRVZFTlQpO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gRGVidWdnZXJIYW5kbGVyO1xuIl19
