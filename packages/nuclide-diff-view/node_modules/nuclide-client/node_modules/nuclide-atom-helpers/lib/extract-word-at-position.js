
/*
 * Copyright (c) 2015-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the license found in the LICENSE file in
 * the root directory of this source tree.
 */

function extractWordAtPosition(editor, position, wordRegex) {
  if (!wordRegex) {
    wordRegex = editor.getLastCursor().wordRegExp();
  }
  var buffer = editor.getBuffer();
  var row = position.row;
  var column = position.column;

  var rowRange = buffer.rangeForRow(row);
  var matchData;
  // Extract the expression from the row text.
  buffer.scanInRange(wordRegex, rowRange, function (data) {
    var range = data.range;

    if (range.containsPoint(position)) {
      matchData = data;
    }
    // Stop the scan if the scanner has passed our position.
    if (range.end.column > column) {
      data.stop();
    }
  });
  if (matchData) {
    return {
      wordMatch: matchData.match,
      range: matchData.range
    };
  } else {
    return null;
  }
}

module.exports = extractWordAtPosition;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBlbW0ySHVwdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLWF0b20taGVscGVycy9saWIvZXh0cmFjdC13b3JkLWF0LXBvc2l0aW9uLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFdBQVcsQ0FBQzs7Ozs7Ozs7OztBQVdaLFNBQVMscUJBQXFCLENBQzFCLE1BQXVCLEVBQ3ZCLFFBQW9CLEVBQ3BCLFNBQWtCLEVBQWlDO0FBQ3JELE1BQUksQ0FBQyxTQUFTLEVBQUU7QUFDZCxhQUFTLEdBQUcsTUFBTSxDQUFDLGFBQWEsRUFBRSxDQUFDLFVBQVUsRUFBRSxDQUFDO0dBQ2pEO0FBQ0QsTUFBSSxNQUFNLEdBQUcsTUFBTSxDQUFDLFNBQVMsRUFBRSxDQUFDO01BQzNCLEdBQUcsR0FBWSxRQUFRLENBQXZCLEdBQUc7TUFBRSxNQUFNLEdBQUksUUFBUSxDQUFsQixNQUFNOztBQUNoQixNQUFJLFFBQVEsR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3ZDLE1BQUksU0FBUyxDQUFDOztBQUVkLFFBQU0sQ0FBQyxXQUFXLENBQUMsU0FBUyxFQUFFLFFBQVEsRUFBRSxVQUFDLElBQUksRUFBSztRQUMzQyxLQUFLLEdBQUksSUFBSSxDQUFiLEtBQUs7O0FBQ1YsUUFBSSxLQUFLLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxFQUFFO0FBQ2pDLGVBQVMsR0FBRyxJQUFJLENBQUM7S0FDbEI7O0FBRUQsUUFBSSxLQUFLLENBQUMsR0FBRyxDQUFDLE1BQU0sR0FBRyxNQUFNLEVBQUU7QUFDN0IsVUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO0tBQ2I7R0FDRixDQUFDLENBQUM7QUFDSCxNQUFJLFNBQVMsRUFBRTtBQUNiLFdBQU87QUFDTCxlQUFTLEVBQUUsU0FBUyxDQUFDLEtBQUs7QUFDMUIsV0FBSyxFQUFFLFNBQVMsQ0FBQyxLQUFLO0tBQ3ZCLENBQUM7R0FDSCxNQUFNO0FBQ0wsV0FBTyxJQUFJLENBQUM7R0FDYjtDQUNGOztBQUVELE1BQU0sQ0FBQyxPQUFPLEdBQUcscUJBQXFCLENBQUMiLCJmaWxlIjoiL3Zhci9mb2xkZXJzL3hmL3JzcGg0X2M1NzMxNXJzNTd4eHNkc2tyeG52MzZ0MC9UL3RtcGVtbTJIdXB1Ymxpc2hfcGFja2FnZXMvbnBtL251Y2xpZGUtYXRvbS1oZWxwZXJzL2xpYi9leHRyYWN0LXdvcmQtYXQtcG9zaXRpb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGJhYmVsJztcbi8qIEBmbG93ICovXG5cbi8qXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgbGljZW5zZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluXG4gKiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqL1xuXG5mdW5jdGlvbiBleHRyYWN0V29yZEF0UG9zaXRpb24oXG4gICAgZWRpdG9yOiBhdG9tJFRleHRFZGl0b3IsXG4gICAgcG9zaXRpb246IGF0b20kUG9pbnQsXG4gICAgd29yZFJlZ2V4OiA/UmVnRXhwKTogP3t3b3JkOiBzdHJpbmc7IHJhbmdlOiBSYW5nZX0ge1xuICBpZiAoIXdvcmRSZWdleCkge1xuICAgIHdvcmRSZWdleCA9IGVkaXRvci5nZXRMYXN0Q3Vyc29yKCkud29yZFJlZ0V4cCgpO1xuICB9XG4gIHZhciBidWZmZXIgPSBlZGl0b3IuZ2V0QnVmZmVyKCk7XG4gIHZhciB7cm93LCBjb2x1bW59ID0gcG9zaXRpb247XG4gIHZhciByb3dSYW5nZSA9IGJ1ZmZlci5yYW5nZUZvclJvdyhyb3cpO1xuICB2YXIgbWF0Y2hEYXRhO1xuICAvLyBFeHRyYWN0IHRoZSBleHByZXNzaW9uIGZyb20gdGhlIHJvdyB0ZXh0LlxuICBidWZmZXIuc2NhbkluUmFuZ2Uod29yZFJlZ2V4LCByb3dSYW5nZSwgKGRhdGEpID0+IHtcbiAgICB2YXIge3JhbmdlfSA9IGRhdGE7XG4gICAgaWYgKHJhbmdlLmNvbnRhaW5zUG9pbnQocG9zaXRpb24pKSB7XG4gICAgICBtYXRjaERhdGEgPSBkYXRhO1xuICAgIH1cbiAgICAvLyBTdG9wIHRoZSBzY2FuIGlmIHRoZSBzY2FubmVyIGhhcyBwYXNzZWQgb3VyIHBvc2l0aW9uLlxuICAgIGlmIChyYW5nZS5lbmQuY29sdW1uID4gY29sdW1uKSB7XG4gICAgICBkYXRhLnN0b3AoKTtcbiAgICB9XG4gIH0pO1xuICBpZiAobWF0Y2hEYXRhKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdvcmRNYXRjaDogbWF0Y2hEYXRhLm1hdGNoLFxuICAgICAgcmFuZ2U6IG1hdGNoRGF0YS5yYW5nZSxcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZXh0cmFjdFdvcmRBdFBvc2l0aW9uO1xuIl19
