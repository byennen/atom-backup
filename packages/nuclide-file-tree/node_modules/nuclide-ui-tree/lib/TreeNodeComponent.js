
/*
 * Copyright (c) 2015-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the license found in the LICENSE file in
 * the root directory of this source tree.
 */
var LazyTreeNode = require('./LazyTreeNode');
var React = require('react-for-atom');
var addons = React.addons;
var PropTypes = React.PropTypes;

var INDENT_IN_PX = 10;
var INDENT_PER_LEVEL_IN_PX = 15;
var DOWN_ARROW = '';
var RIGHT_ARROW = '';
var SPINNER = '';

/**
 * Represents one entry in a TreeComponent.
 */
var TreeNodeComponent = React.createClass({
  displayName: 'TreeNodeComponent',

  propTypes: {
    node: PropTypes.instanceOf(LazyTreeNode).isRequired,
    depth: PropTypes.number.isRequired,
    isContainer: PropTypes.bool.isRequired,
    isExpanded: PropTypes.bool.isRequired,
    isLoading: PropTypes.bool.isRequired,
    isSelected: PropTypes.bool.isRequired,
    label: PropTypes.string.isRequired,
    labelClassName: PropTypes.string.isRequired,
    onClickArrow: PropTypes.func.isRequired,
    onClick: PropTypes.func.isRequired,
    onDoubleClick: PropTypes.func.isRequired,
    onMouseDown: PropTypes.func.isRequired,
    rowClassName: PropTypes.string
  },

  mixins: [addons.PureRenderMixin],

  render: function render() {
    var rowClassNameObj = {
      // Support for selectors in the "file-icons" package.
      // See: https://atom.io/packages/file-icons
      'entry file list-item': true,
      'nuclide-tree-component-item': true,
      'nuclide-tree-component-selected': this.props.isSelected
    };
    if (this.props.rowClassName) {
      rowClassNameObj[this.props.rowClassName] = true;
    }

    var itemStyle = {
      paddingLeft: INDENT_IN_PX + this.props.depth * INDENT_PER_LEVEL_IN_PX
    };

    var arrow;
    if (this.props.isContainer) {
      if (this.props.isExpanded) {
        if (this.props.isLoading) {
          arrow = React.createElement(
            'span',
            { className: 'nuclide-tree-component-item-arrow-spinner' },
            SPINNER
          );
        } else {
          arrow = DOWN_ARROW;
        }
      } else {
        arrow = RIGHT_ARROW;
      }
    }

    return React.createElement(
      'div',
      {
        className: addons.classSet(rowClassNameObj),
        style: itemStyle,
        onClick: this._onClick,
        onDoubleClick: this._onDoubleClick,
        onMouseDown: this._onMouseDown },
      React.createElement(
        'span',
        { className: 'nuclide-tree-component-item-arrow', ref: 'arrow' },
        arrow
      ),
      React.createElement(
        'span',
        {
          className: this.props.labelClassName,
          // `data-name` is support for selectors in the "file-icons" package.
          // See: https://atom.io/packages/file-icons
          'data-name': this.props.label },
        this.props.label
      )
    );
  },

  _onClick: function _onClick(event) {
    if (this.refs['arrow'].getDOMNode().contains(event.target)) {
      this.props.onClickArrow(event, this.props.node);
    } else {
      this.props.onClick(event, this.props.node);
    }
  },

  _onDoubleClick: function _onDoubleClick(event) {
    this.props.onDoubleClick(event, this.props.node);
  },

  _onMouseDown: function _onMouseDown(event) {
    this.props.onMouseDown(event, this.props.node);
  }
});

module.exports = TreeNodeComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBlbW0ySHVwdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXVpLXRyZWUvbGliL1RyZWVOb2RlQ29tcG9uZW50LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFdBQVcsQ0FBQzs7Ozs7Ozs7O0FBVVosSUFBSSxZQUFZLEdBQUcsT0FBTyxDQUFDLGdCQUFnQixDQUFDLENBQUM7QUFDN0MsSUFBSSxLQUFLLEdBQUcsT0FBTyxDQUFDLGdCQUFnQixDQUFDLENBQUM7SUFFcEMsTUFBTSxHQUVKLEtBQUssQ0FGUCxNQUFNO0lBQ04sU0FBUyxHQUNQLEtBQUssQ0FEUCxTQUFTOztBQUdYLElBQUksWUFBWSxHQUFHLEVBQUUsQ0FBQztBQUN0QixJQUFJLHNCQUFzQixHQUFHLEVBQUUsQ0FBQztBQUNoQyxJQUFJLFVBQVUsR0FBRyxHQUFRLENBQUM7QUFDMUIsSUFBSSxXQUFXLEdBQUcsR0FBUSxDQUFDO0FBQzNCLElBQUksT0FBTyxHQUFHLEdBQVEsQ0FBQzs7Ozs7QUFLdkIsSUFBSSxpQkFBaUIsR0FBRyxLQUFLLENBQUMsV0FBVyxDQUFDOzs7QUFDeEMsV0FBUyxFQUFFO0FBQ1QsUUFBSSxFQUFFLFNBQVMsQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDLENBQUMsVUFBVTtBQUNuRCxTQUFLLEVBQUUsU0FBUyxDQUFDLE1BQU0sQ0FBQyxVQUFVO0FBQ2xDLGVBQVcsRUFBRSxTQUFTLENBQUMsSUFBSSxDQUFDLFVBQVU7QUFDdEMsY0FBVSxFQUFFLFNBQVMsQ0FBQyxJQUFJLENBQUMsVUFBVTtBQUNyQyxhQUFTLEVBQUUsU0FBUyxDQUFDLElBQUksQ0FBQyxVQUFVO0FBQ3BDLGNBQVUsRUFBRSxTQUFTLENBQUMsSUFBSSxDQUFDLFVBQVU7QUFDckMsU0FBSyxFQUFFLFNBQVMsQ0FBQyxNQUFNLENBQUMsVUFBVTtBQUNsQyxrQkFBYyxFQUFFLFNBQVMsQ0FBQyxN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Q0FBQyxXQUFXLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7R0FDaEQ7Q0FDRixDQUFDLENBQUM7O0FBRUgsTUFBTSxDQUFDLE9BQU8sR0FBRyxpQkFBaUIsQ0FBQyIsImZpbGUiOiIvdmFyL2ZvbGRlcnMveGYvcnNwaDRfYzU3MzE1cnM1N3h4c2Rza3J4bnYzNnQwL1QvdG1wZW1tMkh1cHVibGlzaF9wYWNrYWdlcy9ucG0vbnVjbGlkZS11aS10cmVlL2xpYi9UcmVlTm9kZUNvbXBvbmVudC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2UgYmFiZWwnO1xuLyogQGZsb3cgKi9cblxuLypcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBsaWNlbnNlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW5cbiAqIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG52YXIgTGF6eVRyZWVOb2RlID0gcmVxdWlyZSgnLi9MYXp5VHJlZU5vZGUnKTtcbnZhciBSZWFjdCA9IHJlcXVpcmUoJ3JlYWN0LWZvci1hdG9tJyk7XG52YXIge1xuICBhZGRvbnMsXG4gIFByb3BUeXBlcyxcbn0gPSBSZWFjdDtcblxudmFyIElOREVOVF9JTl9QWCA9IDEwO1xudmFyIElOREVOVF9QRVJfTEVWRUxfSU5fUFggPSAxNTtcbnZhciBET1dOX0FSUk9XID0gJ1xcdUYwQTMnO1xudmFyIFJJR0hUX0FSUk9XID0gJ1xcdUYwNzgnO1xudmFyIFNQSU5ORVIgPSAnXFx1RjA4Nyc7XG5cbi8qKlxuICogUmVwcmVzZW50cyBvbmUgZW50cnkgaW4gYSBUcmVlQ29tcG9uZW50LlxuICovXG52YXIgVHJlZU5vZGVDb21wb25lbnQgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG4gIHByb3BUeXBlczoge1xuICAgIG5vZGU6IFByb3BUeXBlcy5pbnN0YW5jZU9mKExhenlUcmVlTm9kZSkuaXNSZXF1aXJlZCxcbiAgICBkZXB0aDogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxuICAgIGlzQ29udGFpbmVyOiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLFxuICAgIGlzRXhwYW5kZWQ6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gICAgaXNMb2FkaW5nOiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLFxuICAgIGlzU2VsZWN0ZWQ6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gICAgbGFiZWw6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICBsYWJlbENsYXNzTmFtZTogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgIG9uQ2xpY2tBcnJvdzogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICBvbkNsaWNrOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgIG9uRG91YmxlQ2xpY2s6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgb25Nb3VzZURvd246IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgcm93Q2xhc3NOYW1lOiBQcm9wVHlwZXMuc3RyaW5nLFxuICB9LFxuXG4gIG1peGluczogW1xuICAgIGFkZG9ucy5QdXJlUmVuZGVyTWl4aW4sXG4gIF0sXG5cbiAgcmVuZGVyKCk6IFJlYWN0RWxlbWVudCB7XG4gICAgdmFyIHJvd0NsYXNzTmFtZU9iajoge1trZXk6IHN0cmluZ106IGJvb2xlYW59ID0ge1xuICAgICAgLy8gU3VwcG9ydCBmb3Igc2VsZWN0b3JzIGluIHRoZSBcImZpbGUtaWNvbnNcIiBwYWNrYWdlLlxuICAgICAgLy8gU2VlOiBodHRwczovL2F0b20uaW8vcGFja2FnZXMvZmlsZS1pY29uc1xuICAgICAgJ2VudHJ5IGZpbGUgbGlzdC1pdGVtJzogdHJ1ZSxcbiAgICAgICdudWNsaWRlLXRyZWUtY29tcG9uZW50LWl0ZW0nOiB0cnVlLFxuICAgICAgJ251Y2xpZGUtdHJlZS1jb21wb25lbnQtc2VsZWN0ZWQnOiB0aGlzLnByb3BzLmlzU2VsZWN0ZWQsXG4gICAgfTtcbiAgICBpZiAodGhpcy5wcm9wcy5yb3dDbGFzc05hbWUpIHtcbiAgICAgIHJvd0NsYXNzTmFtZU9ialt0aGlzLnByb3BzLnJvd0NsYXNzTmFtZV0gPSB0cnVlO1xuICAgIH1cblxuICAgIHZhciBpdGVtU3R5bGUgPSB7XG4gICAgICBwYWRkaW5nTGVmdDogSU5ERU5UX0lOX1BYICsgdGhpcy5wcm9wcy5kZXB0aCAqIElOREVOVF9QRVJfTEVWRUxfSU5fUFgsXG4gICAgfTtcblxuICAgIHZhciBhcnJvdztcbiAgICBpZiAodGhpcy5wcm9wcy5pc0NvbnRhaW5lcikge1xuICAgICAgaWYgKHRoaXMucHJvcHMuaXNFeHBhbmRlZCkge1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5pc0xvYWRpbmcpIHtcbiAgICAgICAgICBhcnJvdyA9IDxzcGFuIGNsYXNzTmFtZT0nbnVjbGlkZS10cmVlLWNvbXBvbmVudC1pdGVtLWFycm93LXNwaW5uZXInPntTUElOTkVSfTwvc3Bhbj47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXJyb3cgPSBET1dOX0FSUk9XO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhcnJvdyA9IFJJR0hUX0FSUk9XO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2XG4gICAgICAgIGNsYXNzTmFtZT17YWRkb25zLmNsYXNzU2V0KHJvd0NsYXNzTmFtZU9iail9XG4gICAgICAgIHN0eWxlPXtpdGVtU3R5bGV9XG4gICAgICAgIG9uQ2xpY2s9e3RoaXMuX29uQ2xpY2t9XG4gICAgICAgIG9uRG91YmxlQ2xpY2s9e3RoaXMuX29uRG91YmxlQ2xpY2t9XG4gICAgICAgIG9uTW91c2VEb3duPXt0aGlzLl9vbk1vdXNlRG93bn0+XG4gICAgICAgIDxzcGFuIGNsYXNzTmFtZT0nbnVjbGlkZS10cmVlLWNvbXBvbmVudC1pdGVtLWFycm93JyByZWY9J2Fycm93Jz5cbiAgICAgICAgICB7YXJyb3d9XG4gICAgICAgIDwvc3Bhbj5cbiAgICAgICAgPHNwYW5cbiAgICAgICAgICBjbGFzc05hbWU9e3RoaXMucHJvcHMubGFiZWxDbGFzc05hbWV9XG4gICAgICAgICAgLy8gYGRhdGEtbmFtZWAgaXMgc3VwcG9ydCBmb3Igc2VsZWN0b3JzIGluIHRoZSBcImZpbGUtaWNvbnNcIiBwYWNrYWdlLlxuICAgICAgICAgIC8vIFNlZTogaHR0cHM6Ly9hdG9tLmlvL3BhY2thZ2VzL2ZpbGUtaWNvbnNcbiAgICAgICAgICBkYXRhLW5hbWU9e3RoaXMucHJvcHMubGFiZWx9PlxuICAgICAgICAgIHt0aGlzLnByb3BzLmxhYmVsfVxuICAgICAgICA8L3NwYW4+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9LFxuXG4gIF9vbkNsaWNrKGV2ZW50OiBTeW50aGV0aWNFdmVudCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnJlZnNbJ2Fycm93J10uZ2V0RE9NTm9kZSgpLmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpIHtcbiAgICAgIHRoaXMucHJvcHMub25DbGlja0Fycm93KGV2ZW50LCB0aGlzLnByb3BzLm5vZGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnByb3BzLm9uQ2xpY2soZXZlbnQsIHRoaXMucHJvcHMubm9kZSk7XG4gICAgfVxuICB9LFxuXG4gIF9vbkRvdWJsZUNsaWNrKGV2ZW50OiBTeW50aGV0aWNFdmVudCk6IHZvaWQge1xuICAgIHRoaXMucHJvcHMub25Eb3VibGVDbGljayhldmVudCwgdGhpcy5wcm9wcy5ub2RlKTtcbiAgfSxcblxuICBfb25Nb3VzZURvd24oZXZlbnQ6IFN5bnRoZXRpY0V2ZW50KTogdm9pZCB7XG4gICAgdGhpcy5wcm9wcy5vbk1vdXNlRG93bihldmVudCwgdGhpcy5wcm9wcy5ub2RlKTtcbiAgfSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRyZWVOb2RlQ29tcG9uZW50O1xuIl19
