
/*
 * Copyright (c) 2015-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the license found in the LICENSE file in
 * the root directory of this source tree.
 */

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

/**
 * FileSearch is an object with a query() method.
 * @param directoryUri The directory to get the FileSearch for.
 * @param pathSetUpdater Exposed for testing purposes. The pathSetUpdater to use
 *   in this method--likely a mock.
 */

var fileSearchForDirectory = _asyncToGenerator(function* (directoryUri, pathSetUpdater) {
  var fileSearch = fileSearchForDirectoryUri[directoryUri];
  if (fileSearch) {
    return fileSearch;
  }

  var directory = remoteUri.parse(directoryUri).path;
  var realpath = yield fsPromise.realpath(directory);
  var pathSet = yield createPathSet(realpath);

  var pathSetUpdater = pathSetUpdater || getPathSetUpdater();
  var disposable = yield pathSetUpdater.startUpdatingPathSet(pathSet, realpath);
  // TODO: Stop updating the pathSet when the fileSearch is torn down. But
  // currently the fileSearch is never torn down.

  var pathSearch = new PathSearch(pathSet);
  fileSearch = new FileSearch(realpath, directoryUri, pathSearch);
  fileSearchForDirectoryUri[directoryUri] = fileSearch;
  return fileSearch;
});

// The return values of the following functions must be JSON-serializable so they
// can be sent across a process boundary.

var initFileSearchForDirectory = _asyncToGenerator(function* (directoryUri) {
  yield fileSearchForDirectory(directoryUri);
  return null;
});

var doSearch = _asyncToGenerator(function* (directoryUri, query) {
  var fileSearch = yield fileSearchForDirectory(directoryUri);
  return fileSearch.query(query);
});

function _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, 'next'); var callThrow = step.bind(null, 'throw'); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

var _require = require('./PathSetFactory');

var createPathSet = _require.createPathSet;

var _require2 = require('nuclide-commons');

var fsPromise = _require2.fsPromise;

var remoteUri = require('nuclide-remote-uri');
var urlJoin = require('url-join');

var PathSearch = require('./PathSearch');

/**
 * Utility to search the set of files under `localDirectory`. It attempts to use
 * source control to populate the search space quickly, as well as to exclude
 * source control metadata files from search.
 *
 * @param localDirectory the directory whose files should be searched
 * @param fullUri is the original path provided to `fileSearchForDirectory`,
 *     which is prepended to all results.
 * @param pathSearch delegate to use for the actual searching.
 */

var FileSearch = (function () {
  function FileSearch(localDirectory, fullUri, pathSearch) {
    _classCallCheck(this, FileSearch);

    this._localDirectory = localDirectory;
    this._originalUri = fullUri;
    this._pathSearch = pathSearch;
  }

  _createClass(FileSearch, [{
    key: 'query',
    value: _asyncToGenerator(function* (_query) {
      var _this = this;

      var resultSet = yield this._pathSearch.doQuery(_query);
      // TODO: Cache the result of this call to map().
      return resultSet.results.map(function (result) {
        return { score: result.score,
          path: urlJoin(_this._originalUri, '/', result.value),
          matchIndexes: result.matchIndexes.map(function (index) {
            return index + _this._originalUri.length + 1;
          })
        };
      });
    })
  }, {
    key: 'getLocalDirectory',
    value: function getLocalDirectory() {
      return this._localDirectory;
    }
  }, {
    key: 'getFullBaseUri',
    value: function getFullBaseUri() {
      return this._originalUri;
    }
  }]);

  return FileSearch;
})();

var fileSearchForDirectoryUri = {};

var pathSetUpdater;

function getPathSetUpdater() {
  if (!pathSetUpdater) {
    var PathSetUpdater = require('./PathSetUpdater');
    pathSetUpdater = new PathSetUpdater();
  }
  return pathSetUpdater;
}

module.exports = {
  initFileSearchForDirectory: initFileSearchForDirectory,
  doSearch: doSearch,

  // Currently, this is visible only for testing.
  fileSearchForDirectory: fileSearchForDirectory
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBlbW0ySHVwdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXBhdGgtc2VhcmNoL2xpYi9GaWxlU2VhcmNoLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFdBQVcsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQTRFRyxzQkFBc0IscUJBQXJDLFdBQXNDLFlBQW9CLEVBQUUsY0FBK0IsRUFBdUI7QUFDaEgsTUFBSSxVQUFVLEdBQUcseUJBQXlCLENBQUMsWUFBWSxDQUFDLENBQUM7QUFDekQsTUFBSSxVQUFVLEVBQUU7QUFDZCxXQUFPLFVBQVUsQ0FBQztHQUNuQjs7QUFFRCxNQUFJLFNBQVMsR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQztBQUNuRCxNQUFJLFFBQVEsR0FBRyxNQUFNLFNBQVMsQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDbkQsTUFBSSxPQUFPLEdBQUcsTUFBTSxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7O0FBRTVDLE1BQUksY0FBYyxHQUFHLGNBQWMsSUFBSSxpQkFBaUIsRUFBRSxDQUFDO0FBQzNELE1BQUksVUFBVSxHQUFHLE1BQU0sY0FBYyxDQUFDLG9CQUFvQixDQUFDLE9BQU8sRUFBRSxRQUFRLENBQUMsQ0FBQzs7OztBQUk5RSxNQUFJLFVBQVUsR0FBRyxJQUFJLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUN6QyxZQUFVLEdBQUcsSUFBSSxVQUFVLENBQUMsUUFBUSxFQUFFLFlBQVksRUFBRSxVQUFVLENBQUMsQ0FBQztBQUNoRSwyQkFBeUIsQ0FBQyxZQUFZLENBQUMsR0FBRyxVQUFVLENBQUM7QUFDckQsU0FBTyxVQUFVLENBQUM7Q0FDbkI7Ozs7O0lBZWMsMEJBQTBCLHFCQUF6QyxXQUEwQyxZQUFvQixFQUFpQjtBQUM3RSxRQUFNLHNCQUFzQixDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQzNDLFNBQU8sSUFBSSxDQUFDO0NBQ2I7O0lBRWMsUUFBUSxxQkFBdkIsV0FBd0IsWUFBb0IsRUFBRSxLQUFhLEVBQW9DO0FBQzdGLE1BQUksVUFBVSxHQUFHLE1BQU0sc0JBQXNCLENBQUMsWUFBWSxDQUFDLENBQUM7QUFDNUQsU0FBTyxVQUFVLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO0NBQ2hDOzs7Ozs7ZUEzR3FCLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQzs7SUFBNUMsYUFBYSxZQUFiLGFBQWE7O2dCQUNBLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQzs7SUFBdkMsU0FBUyxhQUFULFNBQVM7O0FBQ2QsSUFBSSxTQUFTLEdBQUcsT0FBTyxDQUFDLG9CQUFvQixDQUFDLENBQUM7QUFDOUMsSUFBSSxPQUFPLEdBQUcsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDOztBQUVsQyxJQUFJLFVBQVUsR0FBRyxPQUFPLENBQUMsY0FBYyxDQUFDLENBQUM7Ozs7Ozs7Ozs7Ozs7SUF5Qm5DLFVBQVU7QUFDSCxXQURQLFVBQVUsQ0FDRixjQUFzQixFQUFFLE9BQWUsRUFBRSxVQUFzQixFQUFFOzBCQUR6RSxVQUFVOztBQUVaLFFBQUksQ0FBQyxlQUFlLEdBQUcsY0FBYyxDQUFDO0FBQ3RDLFFBQUksQ0FBQyxZQUFZLEdBQUcsT0FBTyxDQUFDO0FBQzVCLFFBQUksQ0FBQyxXQUFXLEdBQUcsVUFBVSxDQUFDO0dBQy9COztlQUxHLFVBQVU7OzZCQU9ILFdBQUMsTUFBYSxFQUFvQzs7O0FBQzNELFVBQUksU0FBUyxHQUFHLE1BQU0sSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsTUFBSyxDQUFDLENBQUM7O0FBRXRELGFBQU8sU0FBUyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBQSxNQUFNLEVBQUk7QUFDckMsZUFBTyxFQUFFLEtBQUssRUFBRSxNQUFNLENBQUMsS0FBSztBQUNuQixjQUFJLEVBQUUsT0FBTyxDQUFDLE1BQUssWUFBWSxFQUFFLEdBQUcsRUFBRSxNQUFNLENBQUMsS0FBSyxDQUFDO0FBQ25ELHNCQUFZLEVBQUUsTUFBTSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsVUFBQyxLQUFLO21CQUFLLEtBQUssR0FBRyxNQUFLLFlBQVksQ0FBQyxNQUFNLEdBQUcsQ0FBQztXQUFBLENBQUM7U0FDdkYsQ0FBQztPQUNSLENBQUMsQ0FBQztLQUNOOzs7V0FFZ0IsNkJBQVc7QUFDMUIsYUFBTyxJQUFJLENBQUMsZUFBZSxDQUFDO0tBQzdCOzs7V0FFYSwwQkFBVztBQUN2QixhQUFPLElBQUksQ0FBQyxZQUFZLENBQUM7S0FDMUI7OztTQXhCRyxVQUFVOzs7QUEyQmhCLElBQUkseUJBQXlCLEdBQUcsRUFBRSxDQUFDOztBQTZCbkMsSUFBSSxjQUFjLENBQUM7O0FBRW5CLFNBQVMsaUJBQWlCLEdBQUc7QUFDM0IsTUFBSSxDQUFDLGNBQWMsRUFBRTtBQUNuQixRQUFJLGNBQWMsR0FBRyxPQUFPLENBQUMsa0JBQWtCLENBQUMsQ0FBQztBQUNqRCxrQkFBYyxHQUFHLElBQUksY0FBYyxFQUFFLENBQUM7R0FDdkM7QUFDRCxTQUFPLGNBQWMsQ0FBQztDQUN2Qjs7QUFlRCxNQUFNLENBQUMsT0FBTyxHQUFHO0FBQ2YsNEJBQTBCLEVBQTFCLDBCQUEwQjtBQUMxQixVQUFRLEVBQVIsUUFBUTs7O0FBR1Isd0JBQXNCLEVBQXRCLHNCQUFzQjtDQUN2QixDQUFDIiwiZmlsZSI6Ii92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBlbW0ySHVwdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXBhdGgtc2VhcmNoL2xpYi9GaWxlU2VhcmNoLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCc7XG4vKiBAZmxvdyAqL1xuXG4vKlxuICogQ29weXJpZ2h0IChjKSAyMDE1LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIGxpY2Vuc2UgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpblxuICogdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxudmFyIHtjcmVhdGVQYXRoU2V0fSA9IHJlcXVpcmUoJy4vUGF0aFNldEZhY3RvcnknKTtcbnZhciB7ZnNQcm9taXNlfSA9IHJlcXVpcmUoJ251Y2xpZGUtY29tbW9ucycpO1xudmFyIHJlbW90ZVVyaSA9IHJlcXVpcmUoJ251Y2xpZGUtcmVtb3RlLXVyaScpO1xudmFyIHVybEpvaW4gPSByZXF1aXJlKCd1cmwtam9pbicpO1xuXG52YXIgUGF0aFNlYXJjaCA9IHJlcXVpcmUoJy4vUGF0aFNlYXJjaCcpO1xuXG50eXBlIFF1ZXJ5U2NvcmUgPSB7XG4gIGtleTogc3RyaW5nO1xuICBzdHJpbmc6IHN0cmluZztcbiAgc2NvcmU6IG51bWJlcjtcbiAgbWF0Y2hJbmRleGVzOiBBcnJheTxudW1iZXI+O1xufVxuXG50eXBlIEZpbGVTZWFyY2hSZXN1bHQgPSB7XG4gIHNjb3JlOiBudW1iZXI7XG4gIHBhdGg6IHN0cmluZztcbiAgbWF0Y2hJbmRleGVzOiBBcnJheTxudW1iZXI+O1xufVxuXG4vKipcbiAqIFV0aWxpdHkgdG8gc2VhcmNoIHRoZSBzZXQgb2YgZmlsZXMgdW5kZXIgYGxvY2FsRGlyZWN0b3J5YC4gSXQgYXR0ZW1wdHMgdG8gdXNlXG4gKiBzb3VyY2UgY29udHJvbCB0byBwb3B1bGF0ZSB0aGUgc2VhcmNoIHNwYWNlIHF1aWNrbHksIGFzIHdlbGwgYXMgdG8gZXhjbHVkZVxuICogc291cmNlIGNvbnRyb2wgbWV0YWRhdGEgZmlsZXMgZnJvbSBzZWFyY2guXG4gKlxuICogQHBhcmFtIGxvY2FsRGlyZWN0b3J5IHRoZSBkaXJlY3Rvcnkgd2hvc2UgZmlsZXMgc2hvdWxkIGJlIHNlYXJjaGVkXG4gKiBAcGFyYW0gZnVsbFVyaSBpcyB0aGUgb3JpZ2luYWwgcGF0aCBwcm92aWRlZCB0byBgZmlsZVNlYXJjaEZvckRpcmVjdG9yeWAsXG4gKiAgICAgd2hpY2ggaXMgcHJlcGVuZGVkIHRvIGFsbCByZXN1bHRzLlxuICogQHBhcmFtIHBhdGhTZWFyY2ggZGVsZWdhdGUgdG8gdXNlIGZvciB0aGUgYWN0dWFsIHNlYXJjaGluZy5cbiAqL1xuY2xhc3MgRmlsZVNlYXJjaCB7XG4gIGNvbnN0cnVjdG9yKGxvY2FsRGlyZWN0b3J5OiBzdHJpbmcsIGZ1bGxVcmk6IHN0cmluZywgcGF0aFNlYXJjaDogUGF0aFNlYXJjaCkge1xuICAgIHRoaXMuX2xvY2FsRGlyZWN0b3J5ID0gbG9jYWxEaXJlY3Rvcnk7XG4gICAgdGhpcy5fb3JpZ2luYWxVcmkgPSBmdWxsVXJpO1xuICAgIHRoaXMuX3BhdGhTZWFyY2ggPSBwYXRoU2VhcmNoO1xuICB9XG5cbiAgYXN5bmMgcXVlcnkocXVlcnk6IHN0cmluZyk6IFByb21pc2U8QXJyYXk8RmlsZVNlYXJjaFJlc3VsdD4+IHtcbiAgICB2YXIgcmVzdWx0U2V0ID0gYXdhaXQgdGhpcy5fcGF0aFNlYXJjaC5kb1F1ZXJ5KHF1ZXJ5KTtcbiAgICAvLyBUT0RPOiBDYWNoZSB0aGUgcmVzdWx0IG9mIHRoaXMgY2FsbCB0byBtYXAoKS5cbiAgICByZXR1cm4gcmVzdWx0U2V0LnJlc3VsdHMubWFwKHJlc3VsdCA9PiB7XG4gICAgICByZXR1cm4geyBzY29yZTogcmVzdWx0LnNjb3JlLFxuICAgICAgICAgICAgICAgcGF0aDogdXJsSm9pbih0aGlzLl9vcmlnaW5hbFVyaSwgJy8nLCByZXN1bHQudmFsdWUpLFxuICAgICAgICAgICAgICAgbWF0Y2hJbmRleGVzOiByZXN1bHQubWF0Y2hJbmRleGVzLm1hcCgoaW5kZXgpID0+IGluZGV4ICsgdGhpcy5fb3JpZ2luYWxVcmkubGVuZ3RoICsgMSksXG4gICAgICAgICAgICAgfTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZ2V0TG9jYWxEaXJlY3RvcnkoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5fbG9jYWxEaXJlY3Rvcnk7XG4gIH1cblxuICBnZXRGdWxsQmFzZVVyaSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLl9vcmlnaW5hbFVyaTtcbiAgfVxufVxuXG52YXIgZmlsZVNlYXJjaEZvckRpcmVjdG9yeVVyaSA9IHt9O1xuXG4vKipcbiAqIEZpbGVTZWFyY2ggaXMgYW4gb2JqZWN0IHdpdGggYSBxdWVyeSgpIG1ldGhvZC5cbiAqIEBwYXJhbSBkaXJlY3RvcnlVcmkgVGhlIGRpcmVjdG9yeSB0byBnZXQgdGhlIEZpbGVTZWFyY2ggZm9yLlxuICogQHBhcmFtIHBhdGhTZXRVcGRhdGVyIEV4cG9zZWQgZm9yIHRlc3RpbmcgcHVycG9zZXMuIFRoZSBwYXRoU2V0VXBkYXRlciB0byB1c2VcbiAqICAgaW4gdGhpcyBtZXRob2QtLWxpa2VseSBhIG1vY2suXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGZpbGVTZWFyY2hGb3JEaXJlY3RvcnkoZGlyZWN0b3J5VXJpOiBzdHJpbmcsIHBhdGhTZXRVcGRhdGVyOiA/UGF0aFNldFVwZGF0ZXIpOiBQcm9taXNlPEZpbGVTZWFyY2g+IHtcbiAgdmFyIGZpbGVTZWFyY2ggPSBmaWxlU2VhcmNoRm9yRGlyZWN0b3J5VXJpW2RpcmVjdG9yeVVyaV07XG4gIGlmIChmaWxlU2VhcmNoKSB7XG4gICAgcmV0dXJuIGZpbGVTZWFyY2g7XG4gIH1cblxuICB2YXIgZGlyZWN0b3J5ID0gcmVtb3RlVXJpLnBhcnNlKGRpcmVjdG9yeVVyaSkucGF0aDtcbiAgdmFyIHJlYWxwYXRoID0gYXdhaXQgZnNQcm9taXNlLnJlYWxwYXRoKGRpcmVjdG9yeSk7XG4gIHZhciBwYXRoU2V0ID0gYXdhaXQgY3JlYXRlUGF0aFNldChyZWFscGF0aCk7XG5cbiAgdmFyIHBhdGhTZXRVcGRhdGVyID0gcGF0aFNldFVwZGF0ZXIgfHwgZ2V0UGF0aFNldFVwZGF0ZXIoKTtcbiAgdmFyIGRpc3Bvc2FibGUgPSBhd2FpdCBwYXRoU2V0VXBkYXRlci5zdGFydFVwZGF0aW5nUGF0aFNldChwYXRoU2V0LCByZWFscGF0aCk7XG4gIC8vIFRPRE86IFN0b3AgdXBkYXRpbmcgdGhlIHBhdGhTZXQgd2hlbiB0aGUgZmlsZVNlYXJjaCBpcyB0b3JuIGRvd24uIEJ1dFxuICAvLyBjdXJyZW50bHkgdGhlIGZpbGVTZWFyY2ggaXMgbmV2ZXIgdG9ybiBkb3duLlxuXG4gIHZhciBwYXRoU2VhcmNoID0gbmV3IFBhdGhTZWFyY2gocGF0aFNldCk7XG4gIGZpbGVTZWFyY2ggPSBuZXcgRmlsZVNlYXJjaChyZWFscGF0aCwgZGlyZWN0b3J5VXJpLCBwYXRoU2VhcmNoKTtcbiAgZmlsZVNlYXJjaEZvckRpcmVjdG9yeVVyaVtkaXJlY3RvcnlVcmldID0gZmlsZVNlYXJjaDtcbiAgcmV0dXJuIGZpbGVTZWFyY2g7XG59XG5cbnZhciBwYXRoU2V0VXBkYXRlcjtcblxuZnVuY3Rpb24gZ2V0UGF0aFNldFVwZGF0ZXIoKSB7XG4gIGlmICghcGF0aFNldFVwZGF0ZXIpIHtcbiAgICB2YXIgUGF0aFNldFVwZGF0ZXIgPSByZXF1aXJlKCcuL1BhdGhTZXRVcGRhdGVyJyk7XG4gICAgcGF0aFNldFVwZGF0ZXIgPSBuZXcgUGF0aFNldFVwZGF0ZXIoKTtcbiAgfVxuICByZXR1cm4gcGF0aFNldFVwZGF0ZXI7XG59XG5cbi8vIFRoZSByZXR1cm4gdmFsdWVzIG9mIHRoZSBmb2xsb3dpbmcgZnVuY3Rpb25zIG11c3QgYmUgSlNPTi1zZXJpYWxpemFibGUgc28gdGhleVxuLy8gY2FuIGJlIHNlbnQgYWNyb3NzIGEgcHJvY2VzcyBib3VuZGFyeS5cblxuYXN5bmMgZnVuY3Rpb24gaW5pdEZpbGVTZWFyY2hGb3JEaXJlY3RvcnkoZGlyZWN0b3J5VXJpOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgYXdhaXQgZmlsZVNlYXJjaEZvckRpcmVjdG9yeShkaXJlY3RvcnlVcmkpO1xuICByZXR1cm4gbnVsbDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZG9TZWFyY2goZGlyZWN0b3J5VXJpOiBzdHJpbmcsIHF1ZXJ5OiBzdHJpbmcpOiBQcm9taXNlPEFycmF5PEZpbGVTZWFyY2hSZXN1bHQ+PiB7XG4gIHZhciBmaWxlU2VhcmNoID0gYXdhaXQgZmlsZVNlYXJjaEZvckRpcmVjdG9yeShkaXJlY3RvcnlVcmkpO1xuICByZXR1cm4gZmlsZVNlYXJjaC5xdWVyeShxdWVyeSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBpbml0RmlsZVNlYXJjaEZvckRpcmVjdG9yeSxcbiAgZG9TZWFyY2gsXG5cbiAgLy8gQ3VycmVudGx5LCB0aGlzIGlzIHZpc2libGUgb25seSBmb3IgdGVzdGluZy5cbiAgZmlsZVNlYXJjaEZvckRpcmVjdG9yeSxcbn07XG4iXX0=
