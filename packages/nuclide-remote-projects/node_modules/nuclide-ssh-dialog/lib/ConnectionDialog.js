
/*
 * Copyright (c) 2015-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the license found in the LICENSE file in
 * the root directory of this source tree.
 */

var AtomInput = require('nuclide-ui-atom-input');
var RadioGroup = require('nuclide-ui-radiogroup');

var _require = require('atom');

var CompositeDisposable = _require.CompositeDisposable;

var React = require('react-for-atom');

var _require2 = require('nuclide-remote-connection');

var SshHandshake = _require2.SshHandshake;

var path = require('path');
var logger = require('nuclide-logging').getLogger();

var PropTypes = React.PropTypes;
var SupportedMethods = SshHandshake.SupportedMethods;

var authMethods = [SupportedMethods.PASSWORD, SupportedMethods.SSL_AGENT, SupportedMethods.PRIVATE_KEY];

/** Component to prompt the user for connection details. */
var ConnectionDetailsPrompt = React.createClass({
  displayName: 'ConnectionDetailsPrompt',

  propTypes: {
    initialUsername: PropTypes.string,
    initialServer: PropTypes.string,
    initialCwd: PropTypes.string,
    initialRemoteServerCommand: PropTypes.string,
    initialSshPort: PropTypes.string,
    initialPathToPrivateKey: PropTypes.string,
    initialAuthMethod: PropTypes.shape(Object.keys(SupportedMethods)),
    onConfirm: PropTypes.func.isRequired,
    onCancel: PropTypes.func.isRequired
  },

  getInitialState: function getInitialState() {
    return {
      username: this.props.initialUsername,
      server: this.props.initialServer,
      cwd: this.props.initialCwd,
      remoteServerCommand: this.props.initialRemoteServerCommand,
      sshPort: this.props.initialSshPort,
      pathToPrivateKey: this.props.initialPathToPrivateKey,
      selectedAuthMethodIndex: authMethods.indexOf(this.props.initialAuthMethod)
    };
  },

  handleAuthMethodChange: function handleAuthMethodChange(newIndex) {
    this.setState({
      selectedAuthMethodIndex: newIndex
    });
  },

  _onKeyUp: function _onKeyUp(e) {
    if (e.key === 'Enter') {
      this.props.onConfirm();
    }

    if (e.key === 'Escape') {
      this.props.onCancel();
    }
  },

  _handlePasswordInputClick: function _handlePasswordInputClick(event) {
    var _this = this;

    var passwordAuthMethodIndex = authMethods.indexOf(SupportedMethods.PASSWORD);
    this.setState({
      selectedAuthMethodIndex: passwordAuthMethodIndex
    }, function () {
      React.findDOMNode(_this.refs['password']).focus();
    });
  },

  _handleKeyFileInputClick: function _handleKeyFileInputClick(event) {
    var _this2 = this;

    var privateKeyAuthMethodIndex = authMethods.indexOf(SupportedMethods.PRIVATE_KEY);
    this.setState({
      selectedAuthMethodIndex: privateKeyAuthMethodIndex
    }, function () {
      // when setting this immediately, Atom will unset the focus...
      setTimeout(function () {
        React.findDOMNode(_this2.refs['pathToPrivateKey']).focus();
      }, 0);
    });
  },

  render: function render() {
    var activeAuthMethod = authMethods[this.state.selectedAuthMethodIndex];
    // We need native-key-bindings so that delete works and we need
    // _onKeyUp so that escape and enter work
    var passwordLabel = React.createElement(
      'div',
      { className: 'nuclide-auth-method' },
      React.createElement(
        'div',
        { className: 'nuclide-auth-method-label' },
        'Password:'
      ),
      React.createElement(
        'div',
        { className: 'nuclide-auth-method-input nuclide-auth-method-password' },
        React.createElement('input', { type: 'password',
          className: 'nuclide-password native-key-bindings',
          disabled: activeAuthMethod !== SupportedMethods.PASSWORD,
          ref: 'password',
          onClick: this._handlePasswordInputClick,
          onKeyUp: this._onKeyUp
        })
      )
    );
    var privateKeyLabel = React.createElement(
      'div',
      { className: 'nuclide-auth-method' },
      React.createElement(
        'div',
        { className: 'nuclide-auth-method-label' },
        'Private Key File:'
      ),
      React.createElement(
        'div',
        { className: 'nuclide-auth-method-input nuclide-auth-method-privatekey' },
        React.createElement(AtomInput, {
          ref: 'pathToPrivateKey',
          disabled: activeAuthMethod !== SupportedMethods.PRIVATE_KEY,
          onClick: this._handleKeyFileInputClick,
          placeholder: 'Path to private key',
          initialValue: this.state.pathToPrivateKey
        })
      )
    );
    var sshAgentLabel = React.createElement(
      'div',
      { className: 'nuclide-auth-method' },
      'Use ssh-agent'
    );
    return React.createElement(
      'div',
      { ref: 'root' },
      React.createElement(
        'div',
        { className: 'block' },
        'Username:',
        React.createElement(AtomInput, { ref: 'username', initialValue: this.state.username })
      ),
      React.createElement(
        'div',
        { className: 'block' },
        'Server:',
        React.createElement(AtomInput, { mini: true, ref: 'server', initialValue: this.state.server })
      ),
      React.createElement(
        'div',
        { className: 'block' },
        'Initial Directory:',
        React.createElement(AtomInput, { ref: 'cwd', initialValue: this.state.cwd })
      ),
      React.createElement(
        'div',
        { className: 'block' },
        'Authentication method:'
      ),
      React.createElement(
        'div',
        { className: 'nuclide-auth-selector' },
        React.createElement(RadioGroup, {
          optionLabels: [passwordLabel, sshAgentLabel, privateKeyLabel],
          onSelectedChange: this.handleAuthMethodChange,
          selectedIndex: this.state.selectedAuthMethodIndex
        })
      ),
      React.createElement(
        'div',
        { className: 'block' },
        'Advanced Settings'
      ),
      React.createElement(
        'div',
        { className: 'block' },
        'SSH Port:',
        React.createElement(AtomInput, { ref: 'sshPort', initialValue: this.state.sshPort })
      ),
      React.createElement(
        'div',
        { className: 'block' },
        'Remote Server Command:',
        React.createElement(AtomInput, { ref: 'remoteServerCommand', initialValue: this.state.remoteServerCommand })
      )
    );
  },

  componentDidMount: function componentDidMount() {
    var _this3 = this;

    this._disposables = new CompositeDisposable();
    var root = this.refs['root'].getDOMNode();

    // Hitting enter when this panel has focus should confirm the dialog.
    this._disposables.add(atom.commands.add(root, 'core:confirm', function (event) {
      return _this3.props.onConfirm();
    }));

    // Hitting escape when this panel has focus should cancel the dialog.
    this._disposables.add(atom.commands.add(root, 'core:cancel', function (event) {
      return _this3.props.onCancel();
    }));

    this.refs['username'].focus();
  },

  componentWillUnmount: function componentWillUnmount() {
    if (this._disposables) {
      this._disposables.dispose();
      this._disposables = null;
    }
  },

  getText: function getText(fieldName) {
    return this.refs[fieldName] && this.refs[fieldName].getText().trim() || '';
  },

  getAuthMethod: function getAuthMethod() {
    return authMethods[this.state.selectedAuthMethodIndex];
  },

  getAuthMethodIndex: function getAuthMethodIndex() {
    return this.state.selectedAuthMethodIndex;
  },

  getPassword: function getPassword() {
    return this.refs.password && React.findDOMNode(this.refs.password).value || '';
  }

});

/** Component to prompt the user for authentication information. */
var AuthenticationPrompt = React.createClass({
  displayName: 'AuthenticationPrompt',

  propTypes: {
    instructions: PropTypes.string.isRequired,
    onConfirm: PropTypes.func.isRequired,
    onCancel: PropTypes.func.isRequired
  },

  render: function render() {
    // Instructions may contain newlines that need to be converted to <br> tags.
    var safeHtml = this.props.instructions.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/\\n/g, '<br>');

    // We need native-key-bindings so that delete works and we need
    // _onKeyUp so that escape and enter work
    return React.createElement(
      'div',
      { ref: 'root', className: 'password-prompt-container' },
      React.createElement('div', { className: 'block',
        style: { whiteSpace: 'pre' },
        dangerouslySetInnerHTML: { __html: safeHtml }
      }),
      React.createElement('input', { type: 'password',
        className: 'nuclide-password native-key-bindings',
        ref: 'password',
        onKeyUp: this._onKeyUp })
    );
  },

  _onKeyUp: function _onKeyUp(e) {
    if (e.key === 'Enter') {
      this.props.onConfirm();
    }

    if (e.key === 'Escape') {
      this.props.onCancel();
    }
  },

  componentDidMount: function componentDidMount() {
    var _this4 = this;

    this._disposables = new CompositeDisposable();
    var root = this.refs['root'].getDOMNode();

    // Hitting enter when this panel has focus should confirm the dialog.
    this._disposables.add(atom.commands.add(root, 'core:confirm', function (event) {
      return _this4.props.onConfirm();
    }));

    // Hitting escape when this panel has focus should cancel the dialog.
    this._disposables.add(atom.commands.add(root, 'core:cancel', function (event) {
      return _this4.props.onCancel();
    }));

    React.findDOMNode(this.refs.password).focus();
  },

  componentWillUnmount: function componentWillUnmount() {
    if (this._disposables) {
      this._disposables.dispose();
      this._disposables = null;
    }
  },

  getPassword: function getPassword() {
    return React.findDOMNode(this.refs.password).value;
  }
});

/**
 * Component to entertain the user while he is waiting to hear back from the
 * server.
 */
var IndeterminateProgressBar = React.createClass({
  displayName: 'IndeterminateProgressBar',

  render: function render() {
    return React.createElement(
      'div',
      { className: 'block' },
      React.createElement('span', { className: 'loading loading-spinner-medium inline-block' })
    );
  }
});

var REQUEST_CONNECTION_DETAILS = 1;
var WAITING_FOR_CONNECTION = 2;
var REQUEST_AUTHENTICATION_DETAILS = 3;
var WAITING_FOR_AUTHENTICATION = 4;

/**
 * Component that manages the state transitions as the user connects to a
 * server.
 */
var ConnectionDialog = React.createClass({
  displayName: 'ConnectionDialog',

  propTypes: {
    initialUsername: PropTypes.string,
    initialServer: PropTypes.string,
    initialRemoteServerCommand: PropTypes.string,
    initialCwd: PropTypes.string,
    initialSshPort: PropTypes.string,
    initialPathToPrivateKey: PropTypes.string,
    onConnect: PropTypes.func.isRequired,
    onError: PropTypes.func.isRequired,
    onCancel: PropTypes.func.isRequired,
    onClosed: PropTypes.func
  },

  getInitialState: function getInitialState() {
    var _this5 = this;

    var sshHandshake = new SshHandshake({
      onKeyboardInteractive: function onKeyboardInteractive(name, instructions, instructionsLang, prompts, finish) {
        // TODO: Display all prompts, not just the first one.
        _this5.requestAuthentication(prompts[0], finish);
      },

      onConnect: function onConnect(connection, config) {
        _this5.close(); // Close the dialog.
        _this5.props.onConnect(connection, config);
      },

      onError: function onError(error, config) {
        _this5.close(); // Close the dialog.
        atom.notifications.addError(error.message, { dismissable: true });
        _this5.props.onError(error, config);
        logger.debug(error);
      }
    });

    return {
      mode: REQUEST_CONNECTION_DETAILS,
      instructions: '',
      sshHandshake: sshHandshake,
      finish: function finish(answers) {}
    };
  },

  _getMode: function _getMode() {
    return this.state['mode'];
  },

  render: function render() {
    var mode = this._getMode();
    var content;
    var isOkDisabled;
    if (mode === REQUEST_CONNECTION_DETAILS) {
      // Note React.__spread() is not available in the Atom React fork, so we
      // pass the props explicitly.
      content = React.createElement(ConnectionDetailsPrompt, {
        ref: 'connection-details',
        initialUsername: this.props.initialUsername,
        initialServer: this.props.initialServer,
        initialRemoteServerCommand: this.props.initialRemoteServerCommand,
        initialCwd: this.props.initialCwd,
        initialSshPort: this.props.initialSshPort,
        initialPathToPrivateKey: this.props.initialPathToPrivateKey,
        initialAuthMethod: this.props.initialAuthMethod,
        onConfirm: this.ok,
        onCancel: this.cancel
      });
      isOkDisabled = false;
    } else if (mode === WAITING_FOR_CONNECTION || mode === WAITING_FOR_AUTHENTICATION) {
      content = React.createElement(IndeterminateProgressBar, null);
      isOkDisabled = true;
    } else {
      content = React.createElement(AuthenticationPrompt, { ref: 'authentication',
        instructions: this.state['instructions'],
        onConfirm: this.ok,
        onCancel: this.cancel
      });
      isOkDisabled = false;
    }

    // The root element cannot have a 'key' property, so we use a dummy
    // <div> as the root. Ideally, the <atom-panel> would be the root.
    return React.createElement(
      'div',
      null,
      React.createElement(
        'atom-panel',
        { className: 'modal from-top', key: 'connect-dialog' },
        content,
        React.createElement(
          'div',
          { className: 'block nuclide-ok-cancel' },
          React.createElement(
            'button',
            { className: 'btn', onClick: this.cancel },
            'Cancel'
          ),
          React.createElement(
            'button',
            { className: 'btn btn-primary', onClick: this.ok, disabled: isOkDisabled },
            'OK'
          )
        )
      )
    );
  },

  cancel: function cancel() {
    var mode = this._getMode();

    // It is safe to call cancel even if no connection is started
    this.state.sshHandshake.cancel();

    if (mode === WAITING_FOR_CONNECTION) {
      // TODO(mikeo): Tell delegate to cancel the connection request.
      this.setState({ mode: REQUEST_CONNECTION_DETAILS });
    } else {
      // TODO(mikeo): Also cancel connection request, as appropriate for mode?
      this.props.onCancel();
      this.close();
    }
  },

  close: function close() {
    if (this.props.onClosed) {
      this.props.onClosed();
    }
    var domNode = React.findDOMNode(this);
    if (domNode) {
      React.unmountComponentAtNode(domNode.parentNode);
    }
  },

  ok: function ok() {
    var mode = this._getMode();

    if (mode === REQUEST_CONNECTION_DETAILS) {
      // User is trying to submit connection details.
      var connectionDetailsPrompt = this.refs['connection-details'];
      var pathToPrivateKey = connectionDetailsPrompt.getText('pathToPrivateKey');
      var username = connectionDetailsPrompt.getText('username');
      var server = connectionDetailsPrompt.getText('server');
      var cwd = connectionDetailsPrompt.getText('cwd');
      var sshPort = connectionDetailsPrompt.getText('sshPort');
      var remoteServerCommand = connectionDetailsPrompt.getText('remoteServerCommand');
      var authMethod = connectionDetailsPrompt.getAuthMethod();
      var password = connectionDetailsPrompt.getPassword();
      if (username && server && cwd && remoteServerCommand) {
        this.setState({ mode: WAITING_FOR_CONNECTION });
        this.state.sshHandshake.connect({
          host: server,
          sshPort: sshPort,
          username: username,
          pathToPrivateKey: pathToPrivateKey,
          authMethod: authMethod,
          cwd: cwd,
          remoteServerCommand: remoteServerCommand,
          password: password
        });
      } else {
        // TODO(mbolin): Tell user to fill out all of the fields.
      }
    } else if (mode === REQUEST_AUTHENTICATION_DETAILS) {
        var authenticationPrompt = this.refs['authentication'];
        var password = authenticationPrompt.getPassword();

        this.state.finish([password]);

        this.setState({ mode: WAITING_FOR_AUTHENTICATION });
      }
  },

  requestAuthentication: function requestAuthentication(instructions, finish) {
    this.setState({
      mode: REQUEST_AUTHENTICATION_DETAILS,
      instructions: instructions.prompt,
      finish: finish
    });
  }
});

module.exports = ConnectionDialog;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBlbW0ySHVwdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNzaC1kaWFsb2cvbGliL0Nvbm5lY3Rpb25EaWFsb2cuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsV0FBVyxDQUFDOzs7Ozs7Ozs7O0FBV1osSUFBSSxTQUFTLEdBQUcsT0FBTyxDQUFDLHVCQUF1QixDQUFDLENBQUM7QUFDakQsSUFBSSxVQUFVLEdBQUcsT0FBTyxDQUFDLHVCQUF1QixDQUFDLENBQUM7O2VBQ3RCLE9BQU8sQ0FBQyxNQUFNLENBQUM7O0lBQXRDLG1CQUFtQixZQUFuQixtQkFBbUI7O0FBQ3hCLElBQUksS0FBSyxHQUFHLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDOztnQkFDakIsT0FBTyxDQUFDLDJCQUEyQixDQUFDOztJQUFwRCxZQUFZLGFBQVosWUFBWTs7QUFDakIsSUFBSSxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQzNCLElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDOztJQUUvQyxTQUFTLEdBQUksS0FBSyxDQUFsQixTQUFTO0lBRVQsZ0JBQWdCLEdBQUksWUFBWSxDQUFoQyxnQkFBZ0I7O0FBQ3JCLElBQUksV0FBVyxHQUFHLENBQ2hCLGdCQUFnQixDQUFDLFFBQVEsRUFDekIsZ0JBQWdCLENBQUMsU0FBUyxFQUMxQixnQkFBZ0IsQ0FBQyxXQUFXLENBQzdCLENBQUM7OztBQUdGLElBQUksdUJBQXVCLEdBQUcsS0FBSyxDQUFDLFdBQVcsQ0FBQzs7O0FBQzlDLFdBQVMsRUFBRTtBQUNULG1CQUFlLEVBQUUsU0FBUyxDQUFDLE1BQU07QUFDakMsaUJBQWEsRUFBRSxTQUFTLENBQUMsTUFBTTtBQUMvQixjQUFVLEVBQUUsU0FBUyxDQUFDLE1BQU07QUFDNUIsOEJBQTBCLEVBQUUs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N0csUUFBSSxDQUFDLFFBQVEsQ0FBQztBQUNaLFVBQUksRUFBRSw4QkFBOEI7QUFDcEMsa0JBQVksRUFBRSxZQUFZLENBQUMsTUFBTTtBQUNqQyxZQUFNLEVBQU4sTUFBTTtLQUNQLENBQUMsQ0FBQztHQUNKO0NBQ0YsQ0FBQyxDQUFDOztBQUVILE1BQU0sQ0FBQyxPQUFPLEdBQUcsZ0JBQWdCLENBQUMiLCJmaWxlIjoiL3Zhci9mb2xkZXJzL3hmL3JzcGg0X2M1NzMxNXJzNTd4eHNkc2tyeG52MzZ0MC9UL3RtcGVtbTJIdXB1Ymxpc2hfcGFja2FnZXMvbnBtL251Y2xpZGUtc3NoLWRpYWxvZy9saWIvQ29ubmVjdGlvbkRpYWxvZy5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2UgYmFiZWwnO1xuLyogQGZsb3cgKi9cblxuLypcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBsaWNlbnNlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW5cbiAqIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5cbnZhciBBdG9tSW5wdXQgPSByZXF1aXJlKCdudWNsaWRlLXVpLWF0b20taW5wdXQnKTtcbnZhciBSYWRpb0dyb3VwID0gcmVxdWlyZSgnbnVjbGlkZS11aS1yYWRpb2dyb3VwJyk7XG52YXIge0NvbXBvc2l0ZURpc3Bvc2FibGV9ID0gcmVxdWlyZSgnYXRvbScpO1xudmFyIFJlYWN0ID0gcmVxdWlyZSgncmVhY3QtZm9yLWF0b20nKTtcbnZhciB7U3NoSGFuZHNoYWtlfSA9IHJlcXVpcmUoJ251Y2xpZGUtcmVtb3RlLWNvbm5lY3Rpb24nKTtcbnZhciBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xudmFyIGxvZ2dlciA9IHJlcXVpcmUoJ251Y2xpZGUtbG9nZ2luZycpLmdldExvZ2dlcigpO1xuXG52YXIge1Byb3BUeXBlc30gPSBSZWFjdDtcblxudmFyIHtTdXBwb3J0ZWRNZXRob2RzfSA9IFNzaEhhbmRzaGFrZTtcbnZhciBhdXRoTWV0aG9kcyA9IFtcbiAgU3VwcG9ydGVkTWV0aG9kcy5QQVNTV09SRCxcbiAgU3VwcG9ydGVkTWV0aG9kcy5TU0xfQUdFTlQsXG4gIFN1cHBvcnRlZE1ldGhvZHMuUFJJVkFURV9LRVksXG5dO1xuXG4vKiogQ29tcG9uZW50IHRvIHByb21wdCB0aGUgdXNlciBmb3IgY29ubmVjdGlvbiBkZXRhaWxzLiAqL1xudmFyIENvbm5lY3Rpb25EZXRhaWxzUHJvbXB0ID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICBwcm9wVHlwZXM6IHtcbiAgICBpbml0aWFsVXNlcm5hbWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgaW5pdGlhbFNlcnZlcjogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBpbml0aWFsQ3dkOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIGluaXRpYWxSZW1vdGVTZXJ2ZXJDb21tYW5kOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIGluaXRpYWxTc2hQb3J0OiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIGluaXRpYWxQYXRoVG9Qcml2YXRlS2V5OiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIGluaXRpYWxBdXRoTWV0aG9kOiBQcm9wVHlwZXMuc2hhcGUoT2JqZWN0LmtleXMoU3VwcG9ydGVkTWV0aG9kcykpLFxuICAgIG9uQ29uZmlybTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICBvbkNhbmNlbDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgfSxcblxuICBnZXRJbml0aWFsU3RhdGUoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHVzZXJuYW1lOiB0aGlzLnByb3BzLmluaXRpYWxVc2VybmFtZSxcbiAgICAgIHNlcnZlcjogdGhpcy5wcm9wcy5pbml0aWFsU2VydmVyLFxuICAgICAgY3dkOiB0aGlzLnByb3BzLmluaXRpYWxDd2QsXG4gICAgICByZW1vdGVTZXJ2ZXJDb21tYW5kOiB0aGlzLnByb3BzLmluaXRpYWxSZW1vdGVTZXJ2ZXJDb21tYW5kLFxuICAgICAgc3NoUG9ydDogdGhpcy5wcm9wcy5pbml0aWFsU3NoUG9ydCxcbiAgICAgIHBhdGhUb1ByaXZhdGVLZXk6IHRoaXMucHJvcHMuaW5pdGlhbFBhdGhUb1ByaXZhdGVLZXksXG4gICAgICBzZWxlY3RlZEF1dGhNZXRob2RJbmRleDogYXV0aE1ldGhvZHMuaW5kZXhPZih0aGlzLnByb3BzLmluaXRpYWxBdXRoTWV0aG9kKSxcbiAgICB9O1xuICB9LFxuXG4gIGhhbmRsZUF1dGhNZXRob2RDaGFuZ2UobmV3SW5kZXgpIHtcbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIHNlbGVjdGVkQXV0aE1ldGhvZEluZGV4OiBuZXdJbmRleCxcbiAgICB9KTtcbiAgfSxcblxuICBfb25LZXlVcChlKSB7XG4gICAgaWYoZS5rZXkgPT09ICdFbnRlcicpe1xuICAgICAgdGhpcy5wcm9wcy5vbkNvbmZpcm0oKTtcbiAgICB9XG5cbiAgICBpZihlLmtleSA9PT0gJ0VzY2FwZScpe1xuICAgICAgdGhpcy5wcm9wcy5vbkNhbmNlbCgpO1xuICAgIH1cbiAgfSxcblxuICBfaGFuZGxlUGFzc3dvcmRJbnB1dENsaWNrKGV2ZW50KSB7XG4gICAgdmFyIHBhc3N3b3JkQXV0aE1ldGhvZEluZGV4ID0gYXV0aE1ldGhvZHMuaW5kZXhPZihTdXBwb3J0ZWRNZXRob2RzLlBBU1NXT1JEKTtcbiAgICB0aGlzLnNldFN0YXRlKFxuICAgICAge1xuICAgICAgICBzZWxlY3RlZEF1dGhNZXRob2RJbmRleDogcGFzc3dvcmRBdXRoTWV0aG9kSW5kZXgsXG4gICAgICB9LFxuICAgICAgKCkgPT4ge1xuICAgICAgICBSZWFjdC5maW5kRE9NTm9kZSh0aGlzLnJlZnNbJ3Bhc3N3b3JkJ10pLmZvY3VzKCk7XG4gICAgICB9XG4gICAgKTtcbiAgfSxcblxuICBfaGFuZGxlS2V5RmlsZUlucHV0Q2xpY2soZXZlbnQpIHtcbiAgICB2YXIgcHJpdmF0ZUtleUF1dGhNZXRob2RJbmRleCA9IGF1dGhNZXRob2RzLmluZGV4T2YoU3VwcG9ydGVkTWV0aG9kcy5QUklWQVRFX0tFWSk7XG4gICAgdGhpcy5zZXRTdGF0ZShcbiAgICAgIHtcbiAgICAgICAgc2VsZWN0ZWRBdXRoTWV0aG9kSW5kZXg6IHByaXZhdGVLZXlBdXRoTWV0aG9kSW5kZXgsXG4gICAgICB9LFxuICAgICAgKCkgPT4ge1xuICAgICAgICAvLyB3aGVuIHNldHRpbmcgdGhpcyBpbW1lZGlhdGVseSwgQXRvbSB3aWxsIHVuc2V0IHRoZSBmb2N1cy4uLlxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBSZWFjdC5maW5kRE9NTm9kZSh0aGlzLnJlZnNbJ3BhdGhUb1ByaXZhdGVLZXknXSkuZm9jdXMoKTtcbiAgICAgICAgfSwgMCk7XG4gICAgICB9XG4gICAgKTtcbiAgfSxcblxuICByZW5kZXIoKSB7XG4gICAgdmFyIGFjdGl2ZUF1dGhNZXRob2QgPSBhdXRoTWV0aG9kc1t0aGlzLnN0YXRlLnNlbGVjdGVkQXV0aE1ldGhvZEluZGV4XTtcbiAgICAvLyBXZSBuZWVkIG5hdGl2ZS1rZXktYmluZGluZ3Mgc28gdGhhdCBkZWxldGUgd29ya3MgYW5kIHdlIG5lZWRcbiAgICAvLyBfb25LZXlVcCBzbyB0aGF0IGVzY2FwZSBhbmQgZW50ZXIgd29ya1xuICAgIHZhciBwYXNzd29yZExhYmVsID0gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9J251Y2xpZGUtYXV0aC1tZXRob2QnPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nbnVjbGlkZS1hdXRoLW1ldGhvZC1sYWJlbCc+XG4gICAgICAgICAgUGFzc3dvcmQ6XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nbnVjbGlkZS1hdXRoLW1ldGhvZC1pbnB1dCBudWNsaWRlLWF1dGgtbWV0aG9kLXBhc3N3b3JkJz5cbiAgICAgICAgICA8aW5wdXQgdHlwZT0ncGFzc3dvcmQnXG4gICAgICAgICAgICBjbGFzc05hbWU9J251Y2xpZGUtcGFzc3dvcmQgbmF0aXZlLWtleS1iaW5kaW5ncydcbiAgICAgICAgICAgIGRpc2FibGVkPXthY3RpdmVBdXRoTWV0aG9kICE9PSBTdXBwb3J0ZWRNZXRob2RzLlBBU1NXT1JEfVxuICAgICAgICAgICAgcmVmPSdwYXNzd29yZCdcbiAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuX2hhbmRsZVBhc3N3b3JkSW5wdXRDbGlja31cbiAgICAgICAgICAgIG9uS2V5VXA9e3RoaXMuX29uS2V5VXB9XG4gICAgICAgICAgLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICAgIHZhciBwcml2YXRlS2V5TGFiZWwgPSAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT0nbnVjbGlkZS1hdXRoLW1ldGhvZCc+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPSdudWNsaWRlLWF1dGgtbWV0aG9kLWxhYmVsJz5cbiAgICAgICAgICBQcml2YXRlIEtleSBGaWxlOlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9J251Y2xpZGUtYXV0aC1tZXRob2QtaW5wdXQgbnVjbGlkZS1hdXRoLW1ldGhvZC1wcml2YXRla2V5Jz5cbiAgICAgICAgICA8QXRvbUlucHV0XG4gICAgICAgICAgICByZWY9J3BhdGhUb1ByaXZhdGVLZXknXG4gICAgICAgICAgICBkaXNhYmxlZD17YWN0aXZlQXV0aE1ldGhvZCAhPT0gU3VwcG9ydGVkTWV0aG9kcy5QUklWQVRFX0tFWX1cbiAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuX2hhbmRsZUtleUZpbGVJbnB1dENsaWNrfVxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9J1BhdGggdG8gcHJpdmF0ZSBrZXknXG4gICAgICAgICAgICBpbml0aWFsVmFsdWU9e3RoaXMuc3RhdGUucGF0aFRvUHJpdmF0ZUtleX1cbiAgICAgICAgICAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gICAgdmFyIHNzaEFnZW50TGFiZWwgPSAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT0nbnVjbGlkZS1hdXRoLW1ldGhvZCc+XG4gICAgICAgIFVzZSBzc2gtYWdlbnRcbiAgICAgIDwvZGl2PlxuICAgICk7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgcmVmPSdyb290Jz5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9J2Jsb2NrJz5cbiAgICAgICAgICBVc2VybmFtZTpcbiAgICAgICAgICA8QXRvbUlucHV0IHJlZj0ndXNlcm5hbWUnIGluaXRpYWxWYWx1ZT17dGhpcy5zdGF0ZS51c2VybmFtZX0gLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPSdibG9jayc+XG4gICAgICAgICAgU2VydmVyOlxuICAgICAgICAgIDxBdG9tSW5wdXQgbWluaSByZWY9J3NlcnZlcicgaW5pdGlhbFZhbHVlPXt0aGlzLnN0YXRlLnNlcnZlcn0gLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPSdibG9jayc+XG4gICAgICAgICAgSW5pdGlhbCBEaXJlY3Rvcnk6XG4gICAgICAgICAgPEF0b21JbnB1dCByZWY9J2N3ZCcgaW5pdGlhbFZhbHVlPXt0aGlzLnN0YXRlLmN3ZH0gLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPSdibG9jayc+XG4gICAgICAgICAgQXV0aGVudGljYXRpb24gbWV0aG9kOlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9J251Y2xpZGUtYXV0aC1zZWxlY3Rvcic+XG4gICAgICAgICAgPFJhZGlvR3JvdXBcbiAgICAgICAgICAgIG9wdGlvbkxhYmVscz17W1xuICAgICAgICAgICAgICBwYXNzd29yZExhYmVsLFxuICAgICAgICAgICAgICBzc2hBZ2VudExhYmVsLFxuICAgICAgICAgICAgICBwcml2YXRlS2V5TGFiZWwsXG4gICAgICAgICAgICBdfVxuICAgICAgICAgICAgb25TZWxlY3RlZENoYW5nZT17dGhpcy5oYW5kbGVBdXRoTWV0aG9kQ2hhbmdlfVxuICAgICAgICAgICAgc2VsZWN0ZWRJbmRleD17dGhpcy5zdGF0ZS5zZWxlY3RlZEF1dGhNZXRob2RJbmRleH1cbiAgICAgICAgICAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9J2Jsb2NrJz5cbiAgICAgICAgICBBZHZhbmNlZCBTZXR0aW5nc1xuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9J2Jsb2NrJz5cbiAgICAgICAgICBTU0ggUG9ydDpcbiAgICAgICAgICA8QXRvbUlucHV0IHJlZj0nc3NoUG9ydCcgaW5pdGlhbFZhbHVlPXt0aGlzLnN0YXRlLnNzaFBvcnR9IC8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nYmxvY2snPlxuICAgICAgICAgIFJlbW90ZSBTZXJ2ZXIgQ29tbWFuZDpcbiAgICAgICAgICA8QXRvbUlucHV0IHJlZj0ncmVtb3RlU2VydmVyQ29tbWFuZCcgaW5pdGlhbFZhbHVlPXt0aGlzLnN0YXRlLnJlbW90ZVNlcnZlckNvbW1hbmR9IC8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICB0aGlzLl9kaXNwb3NhYmxlcyA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCk7XG4gICAgdmFyIHJvb3QgPSB0aGlzLnJlZnNbJ3Jvb3QnXS5nZXRET01Ob2RlKCk7XG5cbiAgICAvLyBIaXR0aW5nIGVudGVyIHdoZW4gdGhpcyBwYW5lbCBoYXMgZm9jdXMgc2hvdWxkIGNvbmZpcm0gdGhlIGRpYWxvZy5cbiAgICB0aGlzLl9kaXNwb3NhYmxlcy5hZGQoYXRvbS5jb21tYW5kcy5hZGQoXG4gICAgICAgIHJvb3QsXG4gICAgICAgICdjb3JlOmNvbmZpcm0nLFxuICAgICAgICAoZXZlbnQpID0+IHRoaXMucHJvcHMub25Db25maXJtKCkpKTtcblxuICAgIC8vIEhpdHRpbmcgZXNjYXBlIHdoZW4gdGhpcyBwYW5lbCBoYXMgZm9jdXMgc2hvdWxkIGNhbmNlbCB0aGUgZGlhbG9nLlxuICAgIHRoaXMuX2Rpc3Bvc2FibGVzLmFkZChhdG9tLmNvbW1hbmRzLmFkZChcbiAgICAgICAgcm9vdCxcbiAgICAgICAgJ2NvcmU6Y2FuY2VsJyxcbiAgICAgICAgKGV2ZW50KSA9PiB0aGlzLnByb3BzLm9uQ2FuY2VsKCkpKTtcblxuICAgIHRoaXMucmVmc1sndXNlcm5hbWUnXS5mb2N1cygpO1xuICB9LFxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIGlmICh0aGlzLl9kaXNwb3NhYmxlcykge1xuICAgICAgdGhpcy5fZGlzcG9zYWJsZXMuZGlzcG9zZSgpO1xuICAgICAgdGhpcy5fZGlzcG9zYWJsZXMgPSBudWxsO1xuICAgIH1cbiAgfSxcblxuICBnZXRUZXh0KGZpZWxkTmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gKHRoaXMucmVmc1tmaWVsZE5hbWVdICYmIHRoaXMucmVmc1tmaWVsZE5hbWVdLmdldFRleHQoKS50cmltKCkpIHx8ICcnO1xuICB9LFxuXG4gIGdldEF1dGhNZXRob2QoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYXV0aE1ldGhvZHNbdGhpcy5zdGF0ZS5zZWxlY3RlZEF1dGhNZXRob2RJbmRleF07XG4gIH0sXG5cbiAgZ2V0QXV0aE1ldGhvZEluZGV4KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdGUuc2VsZWN0ZWRBdXRoTWV0aG9kSW5kZXg7XG4gIH0sXG5cbiAgZ2V0UGFzc3dvcmQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gKHRoaXMucmVmcy5wYXNzd29yZCAmJiBSZWFjdC5maW5kRE9NTm9kZSh0aGlzLnJlZnMucGFzc3dvcmQpLnZhbHVlKSB8fCAnJztcbiAgfSxcblxufSk7XG5cbi8qKiBDb21wb25lbnQgdG8gcHJvbXB0IHRoZSB1c2VyIGZvciBhdXRoZW50aWNhdGlvbiBpbmZvcm1hdGlvbi4gKi9cbnZhciBBdXRoZW50aWNhdGlvblByb21wdCA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgcHJvcFR5cGVzOiB7XG4gICAgaW5zdHJ1Y3Rpb25zOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgb25Db25maXJtOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgIG9uQ2FuY2VsOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICB9LFxuXG4gIHJlbmRlcigpIHtcbiAgICAvLyBJbnN0cnVjdGlvbnMgbWF5IGNvbnRhaW4gbmV3bGluZXMgdGhhdCBuZWVkIHRvIGJlIGNvbnZlcnRlZCB0byA8YnI+IHRhZ3MuXG4gICAgdmFyIHNhZmVIdG1sID0gdGhpcy5wcm9wcy5pbnN0cnVjdGlvbnNcbiAgICAgICAgLnJlcGxhY2UoLyYvZywgJyZhbXA7JylcbiAgICAgICAgLnJlcGxhY2UoLzwvZywgJyZsdDsnKVxuICAgICAgICAucmVwbGFjZSgvXFxcXG4vZywgJzxicj4nKTtcblxuXG4gICAgLy8gV2UgbmVlZCBuYXRpdmUta2V5LWJpbmRpbmdzIHNvIHRoYXQgZGVsZXRlIHdvcmtzIGFuZCB3ZSBuZWVkXG4gICAgLy8gX29uS2V5VXAgc28gdGhhdCBlc2NhcGUgYW5kIGVudGVyIHdvcmtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiByZWY9J3Jvb3QnIGNsYXNzTmFtZT0ncGFzc3dvcmQtcHJvbXB0LWNvbnRhaW5lcic+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPSdibG9jaydcbiAgICAgICAgICAgICBzdHlsZT17e3doaXRlU3BhY2U6ICdwcmUnfX1cbiAgICAgICAgICAgICBkYW5nZXJvdXNseVNldElubmVySFRNTD17e19faHRtbDogc2FmZUh0bWx9fVxuICAgICAgICAvPlxuXG4gICAgICAgIDxpbnB1dCB0eXBlPSdwYXNzd29yZCdcbiAgICAgICAgICAgICAgIGNsYXNzTmFtZT0nbnVjbGlkZS1wYXNzd29yZCBuYXRpdmUta2V5LWJpbmRpbmdzJ1xuICAgICAgICAgICAgICAgcmVmPSdwYXNzd29yZCdcbiAgICAgICAgICAgICAgIG9uS2V5VXA9e3RoaXMuX29uS2V5VXB9Lz5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH0sXG5cbiAgX29uS2V5VXAoZSkge1xuICAgIGlmKGUua2V5ID09PSAnRW50ZXInKXtcbiAgICAgIHRoaXMucHJvcHMub25Db25maXJtKCk7XG4gICAgfVxuXG4gICAgaWYoZS5rZXkgPT09ICdFc2NhcGUnKXtcbiAgICAgIHRoaXMucHJvcHMub25DYW5jZWwoKTtcbiAgICB9XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy5fZGlzcG9zYWJsZXMgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpO1xuICAgIHZhciByb290ID0gdGhpcy5yZWZzWydyb290J10uZ2V0RE9NTm9kZSgpO1xuXG4gICAgLy8gSGl0dGluZyBlbnRlciB3aGVuIHRoaXMgcGFuZWwgaGFzIGZvY3VzIHNob3VsZCBjb25maXJtIHRoZSBkaWFsb2cuXG4gICAgdGhpcy5fZGlzcG9zYWJsZXMuYWRkKGF0b20uY29tbWFuZHMuYWRkKFxuICAgICAgICByb290LFxuICAgICAgICAnY29yZTpjb25maXJtJyxcbiAgICAgICAgKGV2ZW50KSA9PiB0aGlzLnByb3BzLm9uQ29uZmlybSgpKSk7XG5cbiAgICAvLyBIaXR0aW5nIGVzY2FwZSB3aGVuIHRoaXMgcGFuZWwgaGFzIGZvY3VzIHNob3VsZCBjYW5jZWwgdGhlIGRpYWxvZy5cbiAgICB0aGlzLl9kaXNwb3NhYmxlcy5hZGQoYXRvbS5jb21tYW5kcy5hZGQoXG4gICAgICAgIHJvb3QsXG4gICAgICAgICdjb3JlOmNhbmNlbCcsXG4gICAgICAgIChldmVudCkgPT4gdGhpcy5wcm9wcy5vbkNhbmNlbCgpKSk7XG5cbiAgICBSZWFjdC5maW5kRE9NTm9kZSh0aGlzLnJlZnMucGFzc3dvcmQpLmZvY3VzKCk7XG4gIH0sXG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgaWYgKHRoaXMuX2Rpc3Bvc2FibGVzKSB7XG4gICAgICB0aGlzLl9kaXNwb3NhYmxlcy5kaXNwb3NlKCk7XG4gICAgICB0aGlzLl9kaXNwb3NhYmxlcyA9IG51bGw7XG4gICAgfVxuICB9LFxuXG4gIGdldFBhc3N3b3JkKCkge1xuICAgIHJldHVybiBSZWFjdC5maW5kRE9NTm9kZSh0aGlzLnJlZnMucGFzc3dvcmQpLnZhbHVlO1xuICB9LFxufSk7XG5cbi8qKlxuICogQ29tcG9uZW50IHRvIGVudGVydGFpbiB0aGUgdXNlciB3aGlsZSBoZSBpcyB3YWl0aW5nIHRvIGhlYXIgYmFjayBmcm9tIHRoZVxuICogc2VydmVyLlxuICovXG52YXIgSW5kZXRlcm1pbmF0ZVByb2dyZXNzQmFyID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPSdibG9jayc+XG4gICAgICAgIDxzcGFuIGNsYXNzTmFtZT0nbG9hZGluZyBsb2FkaW5nLXNwaW5uZXItbWVkaXVtIGlubGluZS1ibG9jayc+PC9zcGFuPlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfSxcbn0pO1xuXG52YXIgUkVRVUVTVF9DT05ORUNUSU9OX0RFVEFJTFMgPSAxO1xudmFyIFdBSVRJTkdfRk9SX0NPTk5FQ1RJT04gPSAyO1xudmFyIFJFUVVFU1RfQVVUSEVOVElDQVRJT05fREVUQUlMUyA9IDM7XG52YXIgV0FJVElOR19GT1JfQVVUSEVOVElDQVRJT04gPSA0O1xuXG4vKipcbiAqIENvbXBvbmVudCB0aGF0IG1hbmFnZXMgdGhlIHN0YXRlIHRyYW5zaXRpb25zIGFzIHRoZSB1c2VyIGNvbm5lY3RzIHRvIGFcbiAqIHNlcnZlci5cbiAqL1xudmFyIENvbm5lY3Rpb25EaWFsb2cgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG4gIHByb3BUeXBlczoge1xuICAgIGluaXRpYWxVc2VybmFtZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBpbml0aWFsU2VydmVyOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIGluaXRpYWxSZW1vdGVTZXJ2ZXJDb21tYW5kOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIGluaXRpYWxDd2Q6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgaW5pdGlhbFNzaFBvcnQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgaW5pdGlhbFBhdGhUb1ByaXZhdGVLZXk6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgb25Db25uZWN0OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgIG9uRXJyb3I6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgb25DYW5jZWw6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgb25DbG9zZWQ6IFByb3BUeXBlcy5mdW5jLFxuICB9LFxuXG4gIGdldEluaXRpYWxTdGF0ZSgpIHtcbiAgICB2YXIgc3NoSGFuZHNoYWtlID0gbmV3IFNzaEhhbmRzaGFrZSh7XG4gICAgICBvbktleWJvYXJkSW50ZXJhY3RpdmU6IChuYW1lLCBpbnN0cnVjdGlvbnMsIGluc3RydWN0aW9uc0xhbmcsIHByb21wdHMsIGZpbmlzaCkgID0+IHtcbiAgICAgICAgLy8gVE9ETzogRGlzcGxheSBhbGwgcHJvbXB0cywgbm90IGp1c3QgdGhlIGZpcnN0IG9uZS5cbiAgICAgICAgdGhpcy5yZXF1ZXN0QXV0aGVudGljYXRpb24ocHJvbXB0c1swXSwgZmluaXNoKTtcbiAgICAgIH0sXG5cbiAgICAgIG9uQ29ubmVjdDogKGNvbm5lY3Rpb246IFNzaEhhbmRzaGFrZSwgY29uZmlnOiBTc2hDb25uZWN0aW9uQ29uZmlndXJhdGlvbikgPT4ge1xuICAgICAgICB0aGlzLmNsb3NlKCk7IC8vIENsb3NlIHRoZSBkaWFsb2cuXG4gICAgICAgIHRoaXMucHJvcHMub25Db25uZWN0KGNvbm5lY3Rpb24sIGNvbmZpZyk7XG4gICAgICB9LFxuXG4gICAgICBvbkVycm9yOiAoZXJyb3I6IEVycm9yLCBjb25maWc6IFNzaENvbm5lY3Rpb25Db25maWd1cmF0aW9uKSA9PiB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTsgLy8gQ2xvc2UgdGhlIGRpYWxvZy5cbiAgICAgICAgYXRvbS5ub3RpZmljYXRpb25zLmFkZEVycm9yKGVycm9yLm1lc3NhZ2UsIHtkaXNtaXNzYWJsZTogdHJ1ZX0pO1xuICAgICAgICB0aGlzLnByb3BzLm9uRXJyb3IoZXJyb3IsIGNvbmZpZyk7XG4gICAgICAgIGxvZ2dlci5kZWJ1ZyhlcnJvcik7XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIG1vZGU6IFJFUVVFU1RfQ09OTkVDVElPTl9ERVRBSUxTLFxuICAgICAgaW5zdHJ1Y3Rpb25zOiAnJyxcbiAgICAgIHNzaEhhbmRzaGFrZTogc3NoSGFuZHNoYWtlLFxuICAgICAgZmluaXNoOiAoYW5zd2VycykgPT4ge30sXG4gICAgfTtcbiAgfSxcblxuICBfZ2V0TW9kZSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLnN0YXRlWydtb2RlJ107XG4gIH0sXG5cbiAgcmVuZGVyKCkge1xuICAgIHZhciBtb2RlID0gdGhpcy5fZ2V0TW9kZSgpO1xuICAgIHZhciBjb250ZW50O1xuICAgIHZhciBpc09rRGlzYWJsZWQ7XG4gICAgaWYgKG1vZGUgPT09IFJFUVVFU1RfQ09OTkVDVElPTl9ERVRBSUxTKSB7XG4gICAgICAvLyBOb3RlIFJlYWN0Ll9fc3ByZWFkKCkgaXMgbm90IGF2YWlsYWJsZSBpbiB0aGUgQXRvbSBSZWFjdCBmb3JrLCBzbyB3ZVxuICAgICAgLy8gcGFzcyB0aGUgcHJvcHMgZXhwbGljaXRseS5cbiAgICAgIGNvbnRlbnQgPSAoXG4gICAgICAgIDxDb25uZWN0aW9uRGV0YWlsc1Byb21wdFxuICAgICAgICAgIHJlZj0nY29ubmVjdGlvbi1kZXRhaWxzJ1xuICAgICAgICAgIGluaXRpYWxVc2VybmFtZT17dGhpcy5wcm9wcy5pbml0aWFsVXNlcm5hbWV9XG4gICAgICAgICAgaW5pdGlhbFNlcnZlcj17dGhpcy5wcm9wcy5pbml0aWFsU2VydmVyfVxuICAgICAgICAgIGluaXRpYWxSZW1vdGVTZXJ2ZXJDb21tYW5kPXt0aGlzLnByb3BzLmluaXRpYWxSZW1vdGVTZXJ2ZXJDb21tYW5kfVxuICAgICAgICAgIGluaXRpYWxDd2Q9e3RoaXMucHJvcHMuaW5pdGlhbEN3ZH1cbiAgICAgICAgICBpbml0aWFsU3NoUG9ydD17dGhpcy5wcm9wcy5pbml0aWFsU3NoUG9ydH1cbiAgICAgICAgICBpbml0aWFsUGF0aFRvUHJpdmF0ZUtleT17dGhpcy5wcm9wcy5pbml0aWFsUGF0aFRvUHJpdmF0ZUtleX1cbiAgICAgICAgICBpbml0aWFsQXV0aE1ldGhvZD17dGhpcy5wcm9wcy5pbml0aWFsQXV0aE1ldGhvZH1cbiAgICAgICAgICBvbkNvbmZpcm09e3RoaXMub2t9XG4gICAgICAgICAgb25DYW5jZWw9e3RoaXMuY2FuY2VsfVxuICAgICAgICAvPlxuICAgICAgKTtcbiAgICAgIGlzT2tEaXNhYmxlZCA9IGZhbHNlO1xuICAgIH0gZWxzZSBpZiAobW9kZSA9PT0gV0FJVElOR19GT1JfQ09OTkVDVElPTiB8fCBtb2RlID09PSBXQUlUSU5HX0ZPUl9BVVRIRU5USUNBVElPTikge1xuICAgICAgY29udGVudCA9IDxJbmRldGVybWluYXRlUHJvZ3Jlc3NCYXIgLz47XG4gICAgICBpc09rRGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb250ZW50ID0gKFxuICAgICAgICA8QXV0aGVudGljYXRpb25Qcm9tcHQgcmVmPSdhdXRoZW50aWNhdGlvbidcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RydWN0aW9ucz17dGhpcy5zdGF0ZVsnaW5zdHJ1Y3Rpb25zJ119XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNvbmZpcm09e3RoaXMub2t9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNhbmNlbD17dGhpcy5jYW5jZWx9XG4gICAgICAvPik7XG4gICAgICBpc09rRGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBUaGUgcm9vdCBlbGVtZW50IGNhbm5vdCBoYXZlIGEgJ2tleScgcHJvcGVydHksIHNvIHdlIHVzZSBhIGR1bW15XG4gICAgLy8gPGRpdj4gYXMgdGhlIHJvb3QuIElkZWFsbHksIHRoZSA8YXRvbS1wYW5lbD4gd291bGQgYmUgdGhlIHJvb3QuXG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXY+XG4gICAgICAgIDxhdG9tLXBhbmVsIGNsYXNzTmFtZT0nbW9kYWwgZnJvbS10b3AnIGtleT0nY29ubmVjdC1kaWFsb2cnPlxuICAgICAgICAgIHtjb250ZW50fVxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdibG9jayBudWNsaWRlLW9rLWNhbmNlbCc+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzTmFtZT0nYnRuJyBvbkNsaWNrPXt0aGlzLmNhbmNlbH0+XG4gICAgICAgICAgICAgIENhbmNlbFxuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzTmFtZT0nYnRuIGJ0bi1wcmltYXJ5JyBvbkNsaWNrPXt0aGlzLm9rfSBkaXNhYmxlZD17aXNPa0Rpc2FibGVkfT5cbiAgICAgICAgICAgICAgT0tcbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2F0b20tcGFuZWw+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9LFxuXG4gIGNhbmNlbCgpIHtcbiAgICB2YXIgbW9kZSA9IHRoaXMuX2dldE1vZGUoKTtcblxuICAgIC8vIEl0IGlzIHNhZmUgdG8gY2FsbCBjYW5jZWwgZXZlbiBpZiBubyBjb25uZWN0aW9uIGlzIHN0YXJ0ZWRcbiAgICB0aGlzLnN0YXRlLnNzaEhhbmRzaGFrZS5jYW5jZWwoKTtcblxuICAgIGlmIChtb2RlID09PSBXQUlUSU5HX0ZPUl9DT05ORUNUSU9OKSB7XG4gICAgICAvLyBUT0RPKG1pa2VvKTogVGVsbCBkZWxlZ2F0ZSB0byBjYW5jZWwgdGhlIGNvbm5lY3Rpb24gcmVxdWVzdC5cbiAgICAgIHRoaXMuc2V0U3RhdGUoe21vZGU6IFJFUVVFU1RfQ09OTkVDVElPTl9ERVRBSUxTfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFRPRE8obWlrZW8pOiBBbHNvIGNhbmNlbCBjb25uZWN0aW9uIHJlcXVlc3QsIGFzIGFwcHJvcHJpYXRlIGZvciBtb2RlP1xuICAgICAgdGhpcy5wcm9wcy5vbkNhbmNlbCgpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfSxcblxuICBjbG9zZSgpIHtcbiAgICBpZiAodGhpcy5wcm9wcy5vbkNsb3NlZCkge1xuICAgICAgdGhpcy5wcm9wcy5vbkNsb3NlZCgpO1xuICAgIH1cbiAgICB2YXIgZG9tTm9kZSA9IFJlYWN0LmZpbmRET01Ob2RlKHRoaXMpO1xuICAgIGlmIChkb21Ob2RlKSB7XG4gICAgICBSZWFjdC51bm1vdW50Q29tcG9uZW50QXROb2RlKGRvbU5vZGUucGFyZW50Tm9kZSk7XG4gICAgfVxuICB9LFxuXG4gIG9rKCkge1xuICAgIHZhciBtb2RlID0gdGhpcy5fZ2V0TW9kZSgpO1xuXG4gICAgaWYgKG1vZGUgPT09IFJFUVVFU1RfQ09OTkVDVElPTl9ERVRBSUxTKSB7XG4gICAgICAvLyBVc2VyIGlzIHRyeWluZyB0byBzdWJtaXQgY29ubmVjdGlvbiBkZXRhaWxzLlxuICAgICAgdmFyIGNvbm5lY3Rpb25EZXRhaWxzUHJvbXB0ID0gdGhpcy5yZWZzWydjb25uZWN0aW9uLWRldGFpbHMnXTtcbiAgICAgIHZhciBwYXRoVG9Qcml2YXRlS2V5ID0gY29ubmVjdGlvbkRldGFpbHNQcm9tcHQuZ2V0VGV4dCgncGF0aFRvUHJpdmF0ZUtleScpO1xuICAgICAgdmFyIHVzZXJuYW1lID0gY29ubmVjdGlvbkRldGFpbHNQcm9tcHQuZ2V0VGV4dCgndXNlcm5hbWUnKTtcbiAgICAgIHZhciBzZXJ2ZXIgPSBjb25uZWN0aW9uRGV0YWlsc1Byb21wdC5nZXRUZXh0KCdzZXJ2ZXInKTtcbiAgICAgIHZhciBjd2QgPSBjb25uZWN0aW9uRGV0YWlsc1Byb21wdC5nZXRUZXh0KCdjd2QnKTtcbiAgICAgIHZhciBzc2hQb3J0ID0gY29ubmVjdGlvbkRldGFpbHNQcm9tcHQuZ2V0VGV4dCgnc3NoUG9ydCcpO1xuICAgICAgdmFyIHJlbW90ZVNlcnZlckNvbW1hbmQgPSBjb25uZWN0aW9uRGV0YWlsc1Byb21wdC5nZXRUZXh0KCdyZW1vdGVTZXJ2ZXJDb21tYW5kJyk7XG4gICAgICB2YXIgYXV0aE1ldGhvZCA9IGNvbm5lY3Rpb25EZXRhaWxzUHJvbXB0LmdldEF1dGhNZXRob2QoKTtcbiAgICAgIHZhciBwYXNzd29yZCA9IGNvbm5lY3Rpb25EZXRhaWxzUHJvbXB0LmdldFBhc3N3b3JkKCk7XG4gICAgICBpZiAodXNlcm5hbWUgJiYgc2VydmVyICYmIGN3ZCAmJiByZW1vdGVTZXJ2ZXJDb21tYW5kKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe21vZGU6IFdBSVRJTkdfRk9SX0NPTk5FQ1RJT059KTtcbiAgICAgICAgdGhpcy5zdGF0ZS5zc2hIYW5kc2hha2UuY29ubmVjdCh7XG4gICAgICAgICAgaG9zdDogc2VydmVyLFxuICAgICAgICAgIHNzaFBvcnQsXG4gICAgICAgICAgdXNlcm5hbWUsXG4gICAgICAgICAgcGF0aFRvUHJpdmF0ZUtleSxcbiAgICAgICAgICBhdXRoTWV0aG9kLFxuICAgICAgICAgIGN3ZCxcbiAgICAgICAgICByZW1vdGVTZXJ2ZXJDb21tYW5kLFxuICAgICAgICAgIHBhc3N3b3JkLFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFRPRE8obWJvbGluKTogVGVsbCB1c2VyIHRvIGZpbGwgb3V0IGFsbCBvZiB0aGUgZmllbGRzLlxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAobW9kZSA9PT0gUkVRVUVTVF9BVVRIRU5USUNBVElPTl9ERVRBSUxTKSB7XG4gICAgICB2YXIgYXV0aGVudGljYXRpb25Qcm9tcHQgPSB0aGlzLnJlZnNbJ2F1dGhlbnRpY2F0aW9uJ107XG4gICAgICB2YXIgcGFzc3dvcmQgPSBhdXRoZW50aWNhdGlvblByb21wdC5nZXRQYXNzd29yZCgpO1xuXG4gICAgICB0aGlzLnN0YXRlLmZpbmlzaChbcGFzc3dvcmRdKTtcblxuICAgICAgdGhpcy5zZXRTdGF0ZSh7bW9kZTogV0FJVElOR19GT1JfQVVUSEVOVElDQVRJT059KTtcbiAgICB9XG4gIH0sXG5cbiAgcmVxdWVzdEF1dGhlbnRpY2F0aW9uKGluc3RydWN0aW9uczoge2VjaG86IGJvb2xlYW47IHByb21wdDogc3RyaW5nfSwgZmluaXNoOiAoYW5zd2VyczogQXJyYXk8c3RyaW5nPikgPT4gdm9pZCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgbW9kZTogUkVRVUVTVF9BVVRIRU5USUNBVElPTl9ERVRBSUxTLFxuICAgICAgaW5zdHJ1Y3Rpb25zOiBpbnN0cnVjdGlvbnMucHJvbXB0LFxuICAgICAgZmluaXNoLFxuICAgIH0pO1xuICB9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gQ29ubmVjdGlvbkRpYWxvZztcbiJdfQ==
